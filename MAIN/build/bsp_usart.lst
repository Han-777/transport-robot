ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 1


   1              		.cpu cortex-m7
   2              		.arch armv7e-m
   3              		.fpu fpv5-d16
   4              		.eabi_attribute 28, 1
   5              		.eabi_attribute 20, 1
   6              		.eabi_attribute 21, 1
   7              		.eabi_attribute 23, 3
   8              		.eabi_attribute 24, 1
   9              		.eabi_attribute 25, 1
  10              		.eabi_attribute 26, 1
  11              		.eabi_attribute 30, 1
  12              		.eabi_attribute 34, 1
  13              		.eabi_attribute 18, 4
  14              		.file	"bsp_usart.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.my_malloc,"ax",%progbits
  19              		.align	1
  20              		.global	my_malloc
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	my_malloc:
  26              	.LVL0:
  27              	.LFB144:
  28              		.file 1 "bsp/usart/bsp_usart.c"
   1:bsp/usart/bsp_usart.c **** /**
   2:bsp/usart/bsp_usart.c ****  * @file bsp_usart.c
   3:bsp/usart/bsp_usart.c ****  * @author Han-777
   4:bsp/usart/bsp_usart.c ****  * @brief  ä¸²å£bspå±‚çš„å®ç°
   5:bsp/usart/bsp_usart.c ****  * @version beta
   6:bsp/usart/bsp_usart.c ****  * @date 2024-07-06
   7:bsp/usart/bsp_usart.c ****  *
   8:bsp/usart/bsp_usart.c ****  * @copyright Copyright (c) 2024
   9:bsp/usart/bsp_usart.c ****  *
  10:bsp/usart/bsp_usart.c ****  */
  11:bsp/usart/bsp_usart.c **** #include "bsp_usart.h"
  12:bsp/usart/bsp_usart.c **** #include "stdlib.h"
  13:bsp/usart/bsp_usart.c **** #include "memory.h"
  14:bsp/usart/bsp_usart.c **** 
  15:bsp/usart/bsp_usart.c **** /*============for virtual usart====================*/
  16:bsp/usart/bsp_usart.c **** #include "bsp_dwt.h"
  17:bsp/usart/bsp_usart.c **** 
  18:bsp/usart/bsp_usart.c **** /* usart service instance, modules' info would be recoreded here using USARTRegister() */
  19:bsp/usart/bsp_usart.c **** /* usartæœåŠ¡å®ä¾‹,æ‰€æœ‰æ³¨å†Œäº†usartçš„æ¨¡å—ä¿¡æ¯ä¼šè¢«ä¿å­˜åœ¨è¿™é‡Œ */
  20:bsp/usart/bsp_usart.c **** static uint8_t usart_instance_idx = 0;
  21:bsp/usart/bsp_usart.c **** static USARTInstance *usart_instance[DEVICE_USART_CNT] = {NULL};
  22:bsp/usart/bsp_usart.c **** 
  23:bsp/usart/bsp_usart.c **** // å†…å­˜å¤„ç†
  24:bsp/usart/bsp_usart.c **** #define MY_SECTION_SIZE_LIMIT 4 * 1024 // 2KB(for memory protection unit), ram size
  25:bsp/usart/bsp_usart.c **** __attribute__((section(".my_section"))) static uint8_t my_section[MY_SECTION_SIZE_LIMIT];
  26:bsp/usart/bsp_usart.c **** static size_t my_section_offset = 0;
  27:bsp/usart/bsp_usart.c **** void *my_malloc(size_t size)
  28:bsp/usart/bsp_usart.c **** {
  29              		.loc 1 28 1 view -0
  30              		.cfi_startproc
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 2


  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
  29:bsp/usart/bsp_usart.c ****     if (my_section_offset + size > MY_SECTION_SIZE_LIMIT)
  34              		.loc 1 29 5 view .LVU1
  35              		.loc 1 29 27 is_stmt 0 view .LVU2
  36 0000 054B     		ldr	r3, .L4
  37 0002 1A68     		ldr	r2, [r3]
  38 0004 1044     		add	r0, r0, r2
  39              	.LVL1:
  40              		.loc 1 29 8 view .LVU3
  41 0006 B0F5805F 		cmp	r0, #4096
  42 000a 00D9     		bls	.L2
  43              	.L3:
  30:bsp/usart/bsp_usart.c ****         while (1)
  44              		.loc 1 30 9 is_stmt 1 discriminator 1 view .LVU4
  31:bsp/usart/bsp_usart.c ****             ;
  45              		.loc 1 31 13 discriminator 1 view .LVU5
  30:bsp/usart/bsp_usart.c ****         while (1)
  46              		.loc 1 30 15 discriminator 1 view .LVU6
  47 000c FEE7     		b	.L3
  48              	.L2:
  32:bsp/usart/bsp_usart.c ****     void *ptr = &my_section[my_section_offset];
  49              		.loc 1 32 5 view .LVU7
  50              	.LVL2:
  33:bsp/usart/bsp_usart.c ****     my_section_offset += size;
  51              		.loc 1 33 5 view .LVU8
  52              		.loc 1 33 23 is_stmt 0 view .LVU9
  53 000e 0249     		ldr	r1, .L4
  54 0010 0860     		str	r0, [r1]
  34:bsp/usart/bsp_usart.c ****     return ptr;
  55              		.loc 1 34 5 is_stmt 1 view .LVU10
  35:bsp/usart/bsp_usart.c **** }
  56              		.loc 1 35 1 is_stmt 0 view .LVU11
  57 0012 0248     		ldr	r0, .L4+4
  58 0014 1044     		add	r0, r0, r2
  59              	.LVL3:
  60              		.loc 1 35 1 view .LVU12
  61 0016 7047     		bx	lr
  62              	.L5:
  63              		.align	2
  64              	.L4:
  65 0018 00000000 		.word	.LANCHOR0
  66 001c 00000000 		.word	my_section
  67              		.cfi_endproc
  68              	.LFE144:
  70              		.section	.text.USARTServiceInit,"ax",%progbits
  71              		.align	1
  72              		.global	USARTServiceInit
  73              		.syntax unified
  74              		.thumb
  75              		.thumb_func
  77              	USARTServiceInit:
  78              	.LVL4:
  79              	.LFB145:
  36:bsp/usart/bsp_usart.c **** 
  37:bsp/usart/bsp_usart.c **** /**
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 3


  38:bsp/usart/bsp_usart.c ****  * @brief å¯åŠ¨ä¸²å£æœåŠ¡,ä¼šåœ¨æ¯ä¸ªå®ä¾‹æ³¨å†Œä¹‹åè‡ªåŠ¨å¯ç”¨æ¥æ”¶,å½“å‰å®ç°ä¸ºDMAæ¥
  39:bsp/usart/bsp_usart.c ****  *
  40:bsp/usart/bsp_usart.c ****  * @todo ä¸²å£æœåŠ¡ä¼šåœ¨æ¯ä¸ªå®ä¾‹æ³¨å†Œä¹‹åè‡ªåŠ¨å¯ç”¨æ¥æ”¶,å½“å‰å®ç°ä¸ºDMAæ¥æ”¶,åç
  41:bsp/usart/bsp_usart.c ****  *       å¯èƒ½è¿˜è¦å°†æ­¤å‡½æ•°ä¿®æ”¹ä¸ºextern,ä½¿å¾—moduleå¯ä»¥æ§åˆ¶ä¸²å£çš„å¯åœ
  42:bsp/usart/bsp_usart.c ****  *
  43:bsp/usart/bsp_usart.c ****  * @param _instance instance owned by module,æ¨¡å—æ‹¥æœ‰çš„ä¸²å£å®ä¾‹
  44:bsp/usart/bsp_usart.c ****  */
  45:bsp/usart/bsp_usart.c **** void USARTServiceInit(USARTInstance *_instance)
  46:bsp/usart/bsp_usart.c **** {
  80              		.loc 1 46 1 is_stmt 1 view -0
  81              		.cfi_startproc
  82              		@ args = 0, pretend = 0, frame = 0
  83              		@ frame_needed = 0, uses_anonymous_args = 0
  84              		.loc 1 46 1 is_stmt 0 view .LVU14
  85 0000 10B5     		push	{r4, lr}
  86              	.LCFI0:
  87              		.cfi_def_cfa_offset 8
  88              		.cfi_offset 4, -8
  89              		.cfi_offset 14, -4
  90 0002 0446     		mov	r4, r0
  47:bsp/usart/bsp_usart.c ****     // HAL_UARTEx_ReceiveToIdle_IT(_instance->usart_handle, _instance->recv_buff, _instance->recv_b
  48:bsp/usart/bsp_usart.c ****     HAL_UARTEx_ReceiveToIdle_DMA(_instance->usart_handle, _instance->recv_buff, _instance->recv_buf
  91              		.loc 1 48 5 is_stmt 1 view .LVU15
  92 0004 8288     		ldrh	r2, [r0, #4]
  93 0006 0168     		ldr	r1, [r0]
  94 0008 8068     		ldr	r0, [r0, #8]
  95              	.LVL5:
  96              		.loc 1 48 5 is_stmt 0 view .LVU16
  97 000a FFF7FEFF 		bl	HAL_UARTEx_ReceiveToIdle_DMA
  98              	.LVL6:
  49:bsp/usart/bsp_usart.c ****     // å…³é—­dma half transferä¸­æ–­é˜²æ­¢ä¸¤æ¬¡è¿›å…¥HAL_UARTEx_RxEventCallback()
  50:bsp/usart/bsp_usart.c ****     // è¿™æ˜¯HALåº“çš„ä¸€ä¸ªè®¾è®¡å¤±è¯¯,å‘ç”ŸDMAä¼ è¾“å®Œæˆ/åŠå®Œæˆä»¥åŠä¸²å£IDLEä¸­æ–­éƒ½ä¼
  51:bsp/usart/bsp_usart.c ****     // æˆ‘ä»¬åªå¸Œæœ›å¤„ç†ç¬¬ä¸€ç§å’Œç¬¬ä¸‰ç§æƒ…å†µ,å› æ­¤ç›´æ¥å…³é—­DMAåŠä¼ è¾“ä¸­æ–­
  52:bsp/usart/bsp_usart.c ****     __HAL_DMA_DISABLE_IT(_instance->usart_handle->hdmarx, DMA_IT_HT);
  99              		.loc 1 52 5 is_stmt 1 view .LVU17
 100 000e A368     		ldr	r3, [r4, #8]
 101 0010 D3F88030 		ldr	r3, [r3, #128]
 102 0014 1B68     		ldr	r3, [r3]
 103 0016 1D49     		ldr	r1, .L11
 104 0018 1D4A     		ldr	r2, .L11+4
 105 001a 9342     		cmp	r3, r2
 106 001c 18BF     		it	ne
 107 001e 8B42     		cmpne	r3, r1
 108 0020 2FD0     		beq	.L7
 109              		.loc 1 52 5 is_stmt 0 discriminator 2 view .LVU18
 110 0022 1832     		adds	r2, r2, #24
 111 0024 9342     		cmp	r3, r2
 112 0026 2CD0     		beq	.L7
 113              		.loc 1 52 5 discriminator 4 view .LVU19
 114 0028 1832     		adds	r2, r2, #24
 115 002a 9342     		cmp	r3, r2
 116 002c 29D0     		beq	.L7
 117              		.loc 1 52 5 discriminator 6 view .LVU20
 118 002e 1832     		adds	r2, r2, #24
 119 0030 9342     		cmp	r3, r2
 120 0032 26D0     		beq	.L7
 121              		.loc 1 52 5 discriminator 8 view .LVU21
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 4


 122 0034 1832     		adds	r2, r2, #24
 123 0036 9342     		cmp	r3, r2
 124 0038 23D0     		beq	.L7
 125              		.loc 1 52 5 discriminator 10 view .LVU22
 126 003a 1832     		adds	r2, r2, #24
 127 003c 9342     		cmp	r3, r2
 128 003e 20D0     		beq	.L7
 129              		.loc 1 52 5 discriminator 12 view .LVU23
 130 0040 1832     		adds	r2, r2, #24
 131 0042 9342     		cmp	r3, r2
 132 0044 1DD0     		beq	.L7
 133              		.loc 1 52 5 discriminator 14 view .LVU24
 134 0046 02F55672 		add	r2, r2, #856
 135 004a 9342     		cmp	r3, r2
 136 004c 19D0     		beq	.L7
 137              		.loc 1 52 5 discriminator 16 view .LVU25
 138 004e 1832     		adds	r2, r2, #24
 139 0050 9342     		cmp	r3, r2
 140 0052 16D0     		beq	.L7
 141              		.loc 1 52 5 discriminator 18 view .LVU26
 142 0054 1832     		adds	r2, r2, #24
 143 0056 9342     		cmp	r3, r2
 144 0058 13D0     		beq	.L7
 145              		.loc 1 52 5 discriminator 20 view .LVU27
 146 005a 1832     		adds	r2, r2, #24
 147 005c 9342     		cmp	r3, r2
 148 005e 10D0     		beq	.L7
 149              		.loc 1 52 5 discriminator 22 view .LVU28
 150 0060 1832     		adds	r2, r2, #24
 151 0062 9342     		cmp	r3, r2
 152 0064 0DD0     		beq	.L7
 153              		.loc 1 52 5 discriminator 24 view .LVU29
 154 0066 1832     		adds	r2, r2, #24
 155 0068 9342     		cmp	r3, r2
 156 006a 0AD0     		beq	.L7
 157              		.loc 1 52 5 discriminator 26 view .LVU30
 158 006c 1832     		adds	r2, r2, #24
 159 006e 9342     		cmp	r3, r2
 160 0070 07D0     		beq	.L7
 161              		.loc 1 52 5 discriminator 28 view .LVU31
 162 0072 1832     		adds	r2, r2, #24
 163 0074 9342     		cmp	r3, r2
 164 0076 04D0     		beq	.L7
 165              		.loc 1 52 5 discriminator 30 view .LVU32
 166 0078 1A68     		ldr	r2, [r3]
 167 007a 22F00402 		bic	r2, r2, #4
 168 007e 1A60     		str	r2, [r3]
  53:bsp/usart/bsp_usart.c **** }
 169              		.loc 1 53 1 discriminator 30 view .LVU33
 170 0080 03E0     		b	.L6
 171              	.L7:
  52:bsp/usart/bsp_usart.c **** }
 172              		.loc 1 52 5 discriminator 29 view .LVU34
 173 0082 1A68     		ldr	r2, [r3]
 174 0084 22F00802 		bic	r2, r2, #8
 175 0088 1A60     		str	r2, [r3]
 176              	.L6:
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 5


 177              		.loc 1 53 1 view .LVU35
 178 008a 10BD     		pop	{r4, pc}
 179              	.LVL7:
 180              	.L12:
 181              		.loc 1 53 1 view .LVU36
 182              		.align	2
 183              	.L11:
 184 008c 10000240 		.word	1073872912
 185 0090 28000240 		.word	1073872936
 186              		.cfi_endproc
 187              	.LFE145:
 189              		.section	.text.USARTRegister,"ax",%progbits
 190              		.align	1
 191              		.global	USARTRegister
 192              		.syntax unified
 193              		.thumb
 194              		.thumb_func
 196              	USARTRegister:
 197              	.LVL8:
 198              	.LFB146:
  54:bsp/usart/bsp_usart.c **** 
  55:bsp/usart/bsp_usart.c **** USARTInstance *USARTRegister(USART_Init_Config_s *init_config)
  56:bsp/usart/bsp_usart.c **** {
 199              		.loc 1 56 1 is_stmt 1 view -0
 200              		.cfi_startproc
 201              		@ args = 0, pretend = 0, frame = 0
 202              		@ frame_needed = 0, uses_anonymous_args = 0
 203              		.loc 1 56 1 is_stmt 0 view .LVU38
 204 0000 38B5     		push	{r3, r4, r5, lr}
 205              	.LCFI1:
 206              		.cfi_def_cfa_offset 16
 207              		.cfi_offset 3, -16
 208              		.cfi_offset 4, -12
 209              		.cfi_offset 5, -8
 210              		.cfi_offset 14, -4
 211 0002 0446     		mov	r4, r0
  57:bsp/usart/bsp_usart.c ****     if (usart_instance_idx > DEVICE_USART_CNT) // è¶…è¿‡æœ€å¤§å®ä¾‹æ•°
 212              		.loc 1 57 5 is_stmt 1 view .LVU39
 213              		.loc 1 57 28 is_stmt 0 view .LVU40
 214 0004 184B     		ldr	r3, .L22
 215 0006 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 216              	.LVL9:
 217              		.loc 1 57 8 view .LVU41
 218 0008 0528     		cmp	r0, #5
 219 000a 0CD9     		bls	.L19
 220              	.L15:
  58:bsp/usart/bsp_usart.c ****         while (1)
 221              		.loc 1 58 9 is_stmt 1 discriminator 1 view .LVU42
  59:bsp/usart/bsp_usart.c ****             ;
 222              		.loc 1 59 13 discriminator 1 view .LVU43
  58:bsp/usart/bsp_usart.c ****         while (1)
 223              		.loc 1 58 15 discriminator 1 view .LVU44
 224 000c FEE7     		b	.L15
 225              	.LVL10:
 226              	.L16:
 227              	.LBB2:
  60:bsp/usart/bsp_usart.c ****     for (uint8_t i = 0; i < usart_instance_idx; i++)
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 6


 228              		.loc 1 60 49 discriminator 2 view .LVU45
 229              		.loc 1 60 50 is_stmt 0 discriminator 2 view .LVU46
 230 000e 0133     		adds	r3, r3, #1
 231              	.LVL11:
 232              		.loc 1 60 50 discriminator 2 view .LVU47
 233 0010 DBB2     		uxtb	r3, r3
 234              	.LVL12:
 235              	.L14:
 236              		.loc 1 60 25 is_stmt 1 discriminator 1 view .LVU48
 237              		.loc 1 60 5 is_stmt 0 discriminator 1 view .LVU49
 238 0012 9842     		cmp	r0, r3
 239 0014 09D9     		bls	.L21
  61:bsp/usart/bsp_usart.c ****     {
  62:bsp/usart/bsp_usart.c ****         if (usart_instance[i]->usart_handle == init_config->usart_handle)
 240              		.loc 1 62 9 is_stmt 1 view .LVU50
 241              		.loc 1 62 27 is_stmt 0 view .LVU51
 242 0016 154A     		ldr	r2, .L22+4
 243 0018 52F82320 		ldr	r2, [r2, r3, lsl #2]
 244              		.loc 1 62 30 view .LVU52
 245 001c 9168     		ldr	r1, [r2, #8]
 246              		.loc 1 62 59 view .LVU53
 247 001e 6268     		ldr	r2, [r4, #4]
 248              		.loc 1 62 12 view .LVU54
 249 0020 9142     		cmp	r1, r2
 250 0022 F4D1     		bne	.L16
 251              	.L17:
  63:bsp/usart/bsp_usart.c ****             while (1)
 252              		.loc 1 63 13 is_stmt 1 discriminator 2 view .LVU55
  64:bsp/usart/bsp_usart.c ****                 // LOGERROR("[bsp_usart]: USART instance %d is already registered!\n", i);
  65:bsp/usart/bsp_usart.c ****                 ;
 253              		.loc 1 65 17 discriminator 2 view .LVU56
  63:bsp/usart/bsp_usart.c ****             while (1)
 254              		.loc 1 63 19 discriminator 2 view .LVU57
 255 0024 FEE7     		b	.L17
 256              	.LVL13:
 257              	.L19:
  60:bsp/usart/bsp_usart.c ****     {
 258              		.loc 1 60 18 is_stmt 0 view .LVU58
 259 0026 0023     		movs	r3, #0
 260 0028 F3E7     		b	.L14
 261              	.LVL14:
 262              	.L21:
  60:bsp/usart/bsp_usart.c ****     {
 263              		.loc 1 60 18 view .LVU59
 264              	.LBE2:
  66:bsp/usart/bsp_usart.c ****     }
  67:bsp/usart/bsp_usart.c ****     USARTInstance *instance = (USARTInstance *)malloc(sizeof(USARTInstance));
 265              		.loc 1 67 5 is_stmt 1 view .LVU60
 266              		.loc 1 67 48 is_stmt 0 view .LVU61
 267 002a 1020     		movs	r0, #16
 268 002c FFF7FEFF 		bl	malloc
 269              	.LVL15:
 270              		.loc 1 67 48 view .LVU62
 271 0030 0546     		mov	r5, r0
 272              	.LVL16:
  68:bsp/usart/bsp_usart.c ****     memset(instance, 0, sizeof(USARTInstance));
 273              		.loc 1 68 5 is_stmt 1 view .LVU63
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 7


 274 0032 0023     		movs	r3, #0
 275 0034 0360     		str	r3, [r0]	@ unaligned
 276 0036 4360     		str	r3, [r0, #4]	@ unaligned
 277 0038 8360     		str	r3, [r0, #8]	@ unaligned
 278 003a C360     		str	r3, [r0, #12]	@ unaligned
  69:bsp/usart/bsp_usart.c **** 
  70:bsp/usart/bsp_usart.c ****     instance->usart_handle = init_config->usart_handle;
 279              		.loc 1 70 5 view .LVU64
 280              		.loc 1 70 41 is_stmt 0 view .LVU65
 281 003c 6368     		ldr	r3, [r4, #4]
 282              		.loc 1 70 28 view .LVU66
 283 003e 8360     		str	r3, [r0, #8]
  71:bsp/usart/bsp_usart.c ****     instance->recv_buff_size = init_config->recv_buff_size;
 284              		.loc 1 71 5 is_stmt 1 view .LVU67
 285              		.loc 1 71 43 is_stmt 0 view .LVU68
 286 0040 2078     		ldrb	r0, [r4]	@ zero_extendqisi2
 287              	.LVL17:
 288              		.loc 1 71 30 view .LVU69
 289 0042 6860     		str	r0, [r5, #4]
  72:bsp/usart/bsp_usart.c ****     instance->module_callback = init_config->module_callback;
 290              		.loc 1 72 5 is_stmt 1 view .LVU70
 291              		.loc 1 72 44 is_stmt 0 view .LVU71
 292 0044 A368     		ldr	r3, [r4, #8]
 293              		.loc 1 72 31 view .LVU72
 294 0046 EB60     		str	r3, [r5, #12]
  73:bsp/usart/bsp_usart.c ****     instance->recv_buff = (uint8_t *)my_malloc(init_config->recv_buff_size);
 295              		.loc 1 73 5 is_stmt 1 view .LVU73
 296              		.loc 1 73 38 is_stmt 0 view .LVU74
 297 0048 FFF7FEFF 		bl	my_malloc
 298              	.LVL18:
 299              		.loc 1 73 25 view .LVU75
 300 004c 2860     		str	r0, [r5]
  74:bsp/usart/bsp_usart.c **** 
  75:bsp/usart/bsp_usart.c ****     usart_instance[usart_instance_idx++] = instance;
 301              		.loc 1 75 5 is_stmt 1 view .LVU76
 302              		.loc 1 75 38 is_stmt 0 view .LVU77
 303 004e 064A     		ldr	r2, .L22
 304 0050 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 305 0052 591C     		adds	r1, r3, #1
 306 0054 1170     		strb	r1, [r2]
 307              		.loc 1 75 42 view .LVU78
 308 0056 054A     		ldr	r2, .L22+4
 309 0058 42F82350 		str	r5, [r2, r3, lsl #2]
  76:bsp/usart/bsp_usart.c ****     USARTServiceInit(instance);
 310              		.loc 1 76 5 is_stmt 1 view .LVU79
 311 005c 2846     		mov	r0, r5
 312 005e FFF7FEFF 		bl	USARTServiceInit
 313              	.LVL19:
  77:bsp/usart/bsp_usart.c ****     return instance;
 314              		.loc 1 77 5 view .LVU80
  78:bsp/usart/bsp_usart.c **** }
 315              		.loc 1 78 1 is_stmt 0 view .LVU81
 316 0062 2846     		mov	r0, r5
 317 0064 38BD     		pop	{r3, r4, r5, pc}
 318              	.LVL20:
 319              	.L23:
 320              		.loc 1 78 1 view .LVU82
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 8


 321 0066 00BF     		.align	2
 322              	.L22:
 323 0068 00000000 		.word	.LANCHOR1
 324 006c 00000000 		.word	.LANCHOR2
 325              		.cfi_endproc
 326              	.LFE146:
 328              		.section	.text.USARTSend,"ax",%progbits
 329              		.align	1
 330              		.global	USARTSend
 331              		.syntax unified
 332              		.thumb
 333              		.thumb_func
 335              	USARTSend:
 336              	.LVL21:
 337              	.LFB147:
  79:bsp/usart/bsp_usart.c **** // double buffer regisitor
  80:bsp/usart/bsp_usart.c **** 
  81:bsp/usart/bsp_usart.c **** /* @todo å½“å‰ä»…è¿›è¡Œäº†å½¢å¼ä¸Šçš„å°è£…,åç»­è¦è¿›ä¸€æ­¥è€ƒè™‘æ˜¯å¦å°†moduleçš„è¡Œä¸ºä¸bs
  82:bsp/usart/bsp_usart.c **** void USARTSend(USARTInstance *_instance, uint8_t *send_buf, uint16_t send_size, USART_TRANSFER_MODE
  83:bsp/usart/bsp_usart.c **** {
 338              		.loc 1 83 1 is_stmt 1 view -0
 339              		.cfi_startproc
 340              		@ args = 0, pretend = 0, frame = 0
 341              		@ frame_needed = 0, uses_anonymous_args = 0
 342              		.loc 1 83 1 is_stmt 0 view .LVU84
 343 0000 08B5     		push	{r3, lr}
 344              	.LCFI2:
 345              		.cfi_def_cfa_offset 8
 346              		.cfi_offset 3, -8
 347              		.cfi_offset 14, -4
  84:bsp/usart/bsp_usart.c ****     switch (mode)
 348              		.loc 1 84 5 is_stmt 1 view .LVU85
 349 0002 022B     		cmp	r3, #2
 350 0004 09D0     		beq	.L25
 351 0006 032B     		cmp	r3, #3
 352 0008 0BD0     		beq	.L26
 353 000a 012B     		cmp	r3, #1
 354 000c 00D0     		beq	.L30
 355              	.L27:
  85:bsp/usart/bsp_usart.c ****     {
  86:bsp/usart/bsp_usart.c ****     case USART_TRANSFER_BLOCKING:
  87:bsp/usart/bsp_usart.c ****         HAL_UART_Transmit(_instance->usart_handle, send_buf, send_size, 100);
  88:bsp/usart/bsp_usart.c ****         break;
  89:bsp/usart/bsp_usart.c ****     case USART_TRANSFER_IT:
  90:bsp/usart/bsp_usart.c ****         HAL_UART_Transmit_IT(_instance->usart_handle, send_buf, send_size);
  91:bsp/usart/bsp_usart.c ****         break;
  92:bsp/usart/bsp_usart.c ****     case USART_TRANSFER_DMA:
  93:bsp/usart/bsp_usart.c ****         HAL_UART_Transmit_DMA(_instance->usart_handle, send_buf, send_size);
  94:bsp/usart/bsp_usart.c ****         break;
  95:bsp/usart/bsp_usart.c ****     default:
  96:bsp/usart/bsp_usart.c ****         while (1)
 356              		.loc 1 96 9 discriminator 1 view .LVU86
  97:bsp/usart/bsp_usart.c ****             ; // illegal mode! check your code context! æ£€æŸ¥å®šä¹‰instanceçš„ä»£ç ä¸Šä¸‹æ–‡,å¯è
 357              		.loc 1 97 13 discriminator 1 view .LVU87
  96:bsp/usart/bsp_usart.c ****             ; // illegal mode! check your code context! æ£€æŸ¥å®šä¹‰instanceçš„ä»£ç ä¸Šä¸‹æ–‡,å¯è
 358              		.loc 1 96 15 discriminator 1 view .LVU88
 359 000e FEE7     		b	.L27
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 9


 360              	.L30:
  87:bsp/usart/bsp_usart.c ****         break;
 361              		.loc 1 87 9 view .LVU89
 362 0010 6423     		movs	r3, #100
 363              	.LVL22:
  87:bsp/usart/bsp_usart.c ****         break;
 364              		.loc 1 87 9 is_stmt 0 view .LVU90
 365 0012 8068     		ldr	r0, [r0, #8]
 366              	.LVL23:
  87:bsp/usart/bsp_usart.c ****         break;
 367              		.loc 1 87 9 view .LVU91
 368 0014 FFF7FEFF 		bl	HAL_UART_Transmit
 369              	.LVL24:
  88:bsp/usart/bsp_usart.c ****     case USART_TRANSFER_IT:
 370              		.loc 1 88 9 is_stmt 1 view .LVU92
 371              	.L24:
  98:bsp/usart/bsp_usart.c ****         break;
  99:bsp/usart/bsp_usart.c ****     }
 100:bsp/usart/bsp_usart.c **** }
 372              		.loc 1 100 1 is_stmt 0 view .LVU93
 373 0018 08BD     		pop	{r3, pc}
 374              	.LVL25:
 375              	.L25:
  90:bsp/usart/bsp_usart.c ****         break;
 376              		.loc 1 90 9 is_stmt 1 view .LVU94
 377 001a 8068     		ldr	r0, [r0, #8]
 378              	.LVL26:
  90:bsp/usart/bsp_usart.c ****         break;
 379              		.loc 1 90 9 is_stmt 0 view .LVU95
 380 001c FFF7FEFF 		bl	HAL_UART_Transmit_IT
 381              	.LVL27:
  91:bsp/usart/bsp_usart.c ****     case USART_TRANSFER_DMA:
 382              		.loc 1 91 9 is_stmt 1 view .LVU96
 383 0020 FAE7     		b	.L24
 384              	.LVL28:
 385              	.L26:
  93:bsp/usart/bsp_usart.c ****         break;
 386              		.loc 1 93 9 view .LVU97
 387 0022 8068     		ldr	r0, [r0, #8]
 388              	.LVL29:
  93:bsp/usart/bsp_usart.c ****         break;
 389              		.loc 1 93 9 is_stmt 0 view .LVU98
 390 0024 FFF7FEFF 		bl	HAL_UART_Transmit_DMA
 391              	.LVL30:
  94:bsp/usart/bsp_usart.c ****     default:
 392              		.loc 1 94 9 is_stmt 1 view .LVU99
 393 0028 F6E7     		b	.L24
 394              		.cfi_endproc
 395              	.LFE147:
 397              		.section	.text.USARTIsReady,"ax",%progbits
 398              		.align	1
 399              		.global	USARTIsReady
 400              		.syntax unified
 401              		.thumb
 402              		.thumb_func
 404              	USARTIsReady:
 405              	.LVL31:
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 10


 406              	.LFB148:
 101:bsp/usart/bsp_usart.c **** 
 102:bsp/usart/bsp_usart.c **** /* ä¸²å£å‘é€æ—¶,gstateä¼šè¢«è®¾ä¸ºBUSY_TX */
 103:bsp/usart/bsp_usart.c **** uint8_t USARTIsReady(USARTInstance *_instance)
 104:bsp/usart/bsp_usart.c **** {
 407              		.loc 1 104 1 view -0
 408              		.cfi_startproc
 409              		@ args = 0, pretend = 0, frame = 0
 410              		@ frame_needed = 0, uses_anonymous_args = 0
 411              		@ link register save eliminated.
 105:bsp/usart/bsp_usart.c ****     if (_instance->usart_handle->gState | HAL_UART_STATE_BUSY_TX)
 412              		.loc 1 105 5 view .LVU101
 413              		.loc 1 105 18 is_stmt 0 view .LVU102
 414 0000 8368     		ldr	r3, [r0, #8]
 415              		.loc 1 105 32 view .LVU103
 416 0002 D3F88830 		ldr	r3, [r3, #136]
 106:bsp/usart/bsp_usart.c ****     {
 107:bsp/usart/bsp_usart.c ****         return 0;
 417              		.loc 1 107 9 is_stmt 1 view .LVU104
 108:bsp/usart/bsp_usart.c ****     }
 109:bsp/usart/bsp_usart.c ****     else
 110:bsp/usart/bsp_usart.c ****     {
 111:bsp/usart/bsp_usart.c ****         return 1;
 112:bsp/usart/bsp_usart.c ****     }
 113:bsp/usart/bsp_usart.c **** }
 418              		.loc 1 113 1 is_stmt 0 view .LVU105
 419 0006 0020     		movs	r0, #0
 420              	.LVL32:
 421              		.loc 1 113 1 view .LVU106
 422 0008 7047     		bx	lr
 423              		.cfi_endproc
 424              	.LFE148:
 426              		.section	.text.HAL_UARTEx_RxEventCallback,"ax",%progbits
 427              		.align	1
 428              		.global	HAL_UARTEx_RxEventCallback
 429              		.syntax unified
 430              		.thumb
 431              		.thumb_func
 433              	HAL_UARTEx_RxEventCallback:
 434              	.LVL33:
 435              	.LFB149:
 114:bsp/usart/bsp_usart.c **** 
 115:bsp/usart/bsp_usart.c **** /**
 116:bsp/usart/bsp_usart.c ****  * @brief æ¯æ¬¡dma/idleä¸­æ–­å‘ç”Ÿæ—¶ï¼Œéƒ½ä¼šè°ƒç”¨æ­¤å‡½æ•°.å¯¹äºæ¯ä¸ªuartå®ä¾‹ä¼šè°ƒç”¨å¯¹å
 117:bsp/usart/bsp_usart.c ****  *        ä¾‹å¦‚:è§†è§‰åè®®è§£æ/é¥æ§å™¨è§£æ/è£åˆ¤ç³»ç»Ÿè§£æ
 118:bsp/usart/bsp_usart.c ****  *
 119:bsp/usart/bsp_usart.c ****  * @note  é€šè¿‡__HAL_DMA_DISABLE_IT(huart->hdmarx,DMA_IT_HT)å…³é—­dma half transferä¸­æ–­é˜²æ­¢ä¸¤
 120:bsp/usart/bsp_usart.c ****  *        è¿™æ˜¯HALåº“çš„ä¸€ä¸ªè®¾è®¡å¤±è¯¯,å‘ç”ŸDMAä¼ è¾“å®Œæˆ/åŠå®Œæˆä»¥åŠä¸²å£IDLEä¸­æ–­éƒ
 121:bsp/usart/bsp_usart.c ****  *        æˆ‘ä»¬åªå¸Œæœ›å¤„ç†ï¼Œå› æ­¤ç›´æ¥å…³é—­DMAåŠä¼ è¾“ä¸­æ–­ç¬¬ä¸€ç§å’Œç¬¬ä¸‰ç§æƒ…å†µ
 122:bsp/usart/bsp_usart.c ****  *
 123:bsp/usart/bsp_usart.c ****  * @param huart å‘ç”Ÿä¸­æ–­çš„ä¸²å£
 124:bsp/usart/bsp_usart.c ****  * @param Size æ­¤æ¬¡æ¥æ”¶åˆ°çš„æ€»æ•°å±…é‡,æš‚æ—¶æ²¡ç”¨
 125:bsp/usart/bsp_usart.c ****  */
 126:bsp/usart/bsp_usart.c **** void HAL_UARTEx_RxEventCallback(UART_HandleTypeDef *huart, uint16_t Size)
 127:bsp/usart/bsp_usart.c **** {
 436              		.loc 1 127 1 is_stmt 1 view -0
 437              		.cfi_startproc
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 11


 438              		@ args = 0, pretend = 0, frame = 0
 439              		@ frame_needed = 0, uses_anonymous_args = 0
 440              		.loc 1 127 1 is_stmt 0 view .LVU108
 441 0000 38B5     		push	{r3, r4, r5, lr}
 442              	.LCFI3:
 443              		.cfi_def_cfa_offset 16
 444              		.cfi_offset 3, -16
 445              		.cfi_offset 4, -12
 446              		.cfi_offset 5, -8
 447              		.cfi_offset 14, -4
 128:bsp/usart/bsp_usart.c ****     for (uint8_t i = 0; i < usart_instance_idx; ++i)
 448              		.loc 1 128 5 is_stmt 1 view .LVU109
 449              	.LBB3:
 450              		.loc 1 128 10 view .LVU110
 451              	.LVL34:
 452              		.loc 1 128 18 is_stmt 0 view .LVU111
 453 0002 0023     		movs	r3, #0
 454              		.loc 1 128 5 view .LVU112
 455 0004 06E0     		b	.L33
 456              	.LVL35:
 457              	.L36:
 129:bsp/usart/bsp_usart.c ****     {
 130:bsp/usart/bsp_usart.c ****         if (huart == usart_instance[i]->usart_handle)
 131:bsp/usart/bsp_usart.c ****         {
 132:bsp/usart/bsp_usart.c ****             if (usart_instance[i]->module_callback != NULL)
 133:bsp/usart/bsp_usart.c ****             {
 134:bsp/usart/bsp_usart.c ****                 // SCB_CleanInvalidateDCache(); // the easiest way with lowest efficiency
 135:bsp/usart/bsp_usart.c ****                 // SCB_InvalidateDCache(); // [cache<-sram]ç¨å¾®é«˜ä¸€äº›(SCB_CleanDCache[cache->s
 136:bsp/usart/bsp_usart.c ****                 // SCB_InvalidateDCache_by_Addr((uint32_t *)usart_instance[i]->recv_buff, (usart_in
 137:bsp/usart/bsp_usart.c ****                 usart_instance[i]->module_callback(huart, Size);
 138:bsp/usart/bsp_usart.c ****                 // memset(usart_instance[i]->recv_buff, 0, Size); // æ¥æ”¶ç»“æŸåæ¸…ç©ºbuffer,å¯
 139:bsp/usart/bsp_usart.c ****             }
 140:bsp/usart/bsp_usart.c ****             HAL_UARTEx_ReceiveToIdle_DMA(usart_instance[i]->usart_handle, usart_instance[i]->recv_b
 141:bsp/usart/bsp_usart.c ****             // HAL_UARTEx_Receiv eToIdle_IT(usart_instance[i]->usart_handle, usart_instance[i]->rec
 142:bsp/usart/bsp_usart.c ****             __HAL_DMA_DISABLE_IT(usart_instance[i]->usart_handle->hdmarx, DMA_IT_HT);
 458              		.loc 1 142 13 discriminator 29 view .LVU113
 459 0006 1A68     		ldr	r2, [r3]
 460 0008 22F00802 		bic	r2, r2, #8
 461 000c 1A60     		str	r2, [r3]
 462              	.L32:
 463              		.loc 1 142 13 discriminator 29 view .LVU114
 464              	.LBE3:
 143:bsp/usart/bsp_usart.c ****             return; // break the loop
 144:bsp/usart/bsp_usart.c ****         }
 145:bsp/usart/bsp_usart.c ****     }
 146:bsp/usart/bsp_usart.c **** }
 465              		.loc 1 146 1 view .LVU115
 466 000e 38BD     		pop	{r3, r4, r5, pc}
 467              	.LVL36:
 468              	.L34:
 469              	.LBB4:
 128:bsp/usart/bsp_usart.c ****     {
 470              		.loc 1 128 49 is_stmt 1 discriminator 2 view .LVU116
 471 0010 0133     		adds	r3, r3, #1
 472              	.LVL37:
 128:bsp/usart/bsp_usart.c ****     {
 473              		.loc 1 128 49 is_stmt 0 discriminator 2 view .LVU117
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 12


 474 0012 DBB2     		uxtb	r3, r3
 475              	.LVL38:
 476              	.L33:
 128:bsp/usart/bsp_usart.c ****     {
 477              		.loc 1 128 25 is_stmt 1 discriminator 1 view .LVU118
 128:bsp/usart/bsp_usart.c ****     {
 478              		.loc 1 128 27 is_stmt 0 discriminator 1 view .LVU119
 479 0014 284A     		ldr	r2, .L42
 480 0016 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 128:bsp/usart/bsp_usart.c ****     {
 481              		.loc 1 128 5 discriminator 1 view .LVU120
 482 0018 9A42     		cmp	r2, r3
 483 001a F8D9     		bls	.L32
 130:bsp/usart/bsp_usart.c ****         {
 484              		.loc 1 130 9 is_stmt 1 view .LVU121
 130:bsp/usart/bsp_usart.c ****         {
 485              		.loc 1 130 36 is_stmt 0 view .LVU122
 486 001c 1C46     		mov	r4, r3
 487 001e 274A     		ldr	r2, .L42+4
 488 0020 52F82320 		ldr	r2, [r2, r3, lsl #2]
 130:bsp/usart/bsp_usart.c ****         {
 489              		.loc 1 130 12 view .LVU123
 490 0024 9568     		ldr	r5, [r2, #8]
 491 0026 8542     		cmp	r5, r0
 492 0028 F2D1     		bne	.L34
 132:bsp/usart/bsp_usart.c ****             {
 493              		.loc 1 132 13 is_stmt 1 view .LVU124
 132:bsp/usart/bsp_usart.c ****             {
 494              		.loc 1 132 34 is_stmt 0 view .LVU125
 495 002a D368     		ldr	r3, [r2, #12]
 496              	.LVL39:
 132:bsp/usart/bsp_usart.c ****             {
 497              		.loc 1 132 16 view .LVU126
 498 002c 03B1     		cbz	r3, .L35
 137:bsp/usart/bsp_usart.c ****                 // memset(usart_instance[i]->recv_buff, 0, Size); // æ¥æ”¶ç»“æŸåæ¸…ç©ºbuffer,å¯
 499              		.loc 1 137 17 is_stmt 1 view .LVU127
 500 002e 9847     		blx	r3
 501              	.LVL40:
 502              	.L35:
 140:bsp/usart/bsp_usart.c ****             // HAL_UARTEx_Receiv eToIdle_IT(usart_instance[i]->usart_handle, usart_instance[i]->rec
 503              		.loc 1 140 13 view .LVU128
 140:bsp/usart/bsp_usart.c ****             // HAL_UARTEx_Receiv eToIdle_IT(usart_instance[i]->usart_handle, usart_instance[i]->rec
 504              		.loc 1 140 56 is_stmt 0 view .LVU129
 505 0030 224D     		ldr	r5, .L42+4
 506 0032 55F82430 		ldr	r3, [r5, r4, lsl #2]
 140:bsp/usart/bsp_usart.c ****             // HAL_UARTEx_Receiv eToIdle_IT(usart_instance[i]->usart_handle, usart_instance[i]->rec
 507              		.loc 1 140 13 view .LVU130
 508 0036 9A88     		ldrh	r2, [r3, #4]
 509 0038 1968     		ldr	r1, [r3]
 510 003a 9868     		ldr	r0, [r3, #8]
 511 003c FFF7FEFF 		bl	HAL_UARTEx_ReceiveToIdle_DMA
 512              	.LVL41:
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 513              		.loc 1 142 13 is_stmt 1 view .LVU131
 514 0040 55F82430 		ldr	r3, [r5, r4, lsl #2]
 515 0044 9B68     		ldr	r3, [r3, #8]
 516 0046 D3F88030 		ldr	r3, [r3, #128]
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 13


 517 004a 1B68     		ldr	r3, [r3]
 518 004c 1C49     		ldr	r1, .L42+8
 519 004e 1D4A     		ldr	r2, .L42+12
 520 0050 9342     		cmp	r3, r2
 521 0052 18BF     		it	ne
 522 0054 8B42     		cmpne	r3, r1
 523 0056 D6D0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 524              		.loc 1 142 13 is_stmt 0 discriminator 2 view .LVU132
 525 0058 1832     		adds	r2, r2, #24
 526 005a 9342     		cmp	r3, r2
 527 005c D3D0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 528              		.loc 1 142 13 discriminator 4 view .LVU133
 529 005e 1832     		adds	r2, r2, #24
 530 0060 9342     		cmp	r3, r2
 531 0062 D0D0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 532              		.loc 1 142 13 discriminator 6 view .LVU134
 533 0064 1832     		adds	r2, r2, #24
 534 0066 9342     		cmp	r3, r2
 535 0068 CDD0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 536              		.loc 1 142 13 discriminator 8 view .LVU135
 537 006a 1832     		adds	r2, r2, #24
 538 006c 9342     		cmp	r3, r2
 539 006e CAD0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 540              		.loc 1 142 13 discriminator 10 view .LVU136
 541 0070 1832     		adds	r2, r2, #24
 542 0072 9342     		cmp	r3, r2
 543 0074 C7D0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 544              		.loc 1 142 13 discriminator 12 view .LVU137
 545 0076 1832     		adds	r2, r2, #24
 546 0078 9342     		cmp	r3, r2
 547 007a C4D0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 548              		.loc 1 142 13 discriminator 14 view .LVU138
 549 007c 02F55672 		add	r2, r2, #856
 550 0080 9342     		cmp	r3, r2
 551 0082 C0D0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 552              		.loc 1 142 13 discriminator 16 view .LVU139
 553 0084 1832     		adds	r2, r2, #24
 554 0086 9342     		cmp	r3, r2
 555 0088 BDD0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 556              		.loc 1 142 13 discriminator 18 view .LVU140
 557 008a 1832     		adds	r2, r2, #24
 558 008c 9342     		cmp	r3, r2
 559 008e BAD0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 560              		.loc 1 142 13 discriminator 20 view .LVU141
 561 0090 1832     		adds	r2, r2, #24
 562 0092 9342     		cmp	r3, r2
 563 0094 B7D0     		beq	.L36
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 14


 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 564              		.loc 1 142 13 discriminator 22 view .LVU142
 565 0096 1832     		adds	r2, r2, #24
 566 0098 9342     		cmp	r3, r2
 567 009a B4D0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 568              		.loc 1 142 13 discriminator 24 view .LVU143
 569 009c 1832     		adds	r2, r2, #24
 570 009e 9342     		cmp	r3, r2
 571 00a0 B1D0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 572              		.loc 1 142 13 discriminator 26 view .LVU144
 573 00a2 1832     		adds	r2, r2, #24
 574 00a4 9342     		cmp	r3, r2
 575 00a6 AED0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 576              		.loc 1 142 13 discriminator 28 view .LVU145
 577 00a8 1832     		adds	r2, r2, #24
 578 00aa 9342     		cmp	r3, r2
 579 00ac ABD0     		beq	.L36
 142:bsp/usart/bsp_usart.c ****             return; // break the loop
 580              		.loc 1 142 13 discriminator 30 view .LVU146
 581 00ae 1A68     		ldr	r2, [r3]
 582 00b0 22F00402 		bic	r2, r2, #4
 583 00b4 1A60     		str	r2, [r3]
 143:bsp/usart/bsp_usart.c ****         }
 584              		.loc 1 143 13 is_stmt 1 discriminator 30 view .LVU147
 585 00b6 AAE7     		b	.L32
 586              	.L43:
 587              		.align	2
 588              	.L42:
 589 00b8 00000000 		.word	.LANCHOR1
 590 00bc 00000000 		.word	.LANCHOR2
 591 00c0 10000240 		.word	1073872912
 592 00c4 28000240 		.word	1073872936
 593              	.LBE4:
 594              		.cfi_endproc
 595              	.LFE149:
 597              		.section	.text.HAL_UART_ErrorCallback,"ax",%progbits
 598              		.align	1
 599              		.global	HAL_UART_ErrorCallback
 600              		.syntax unified
 601              		.thumb
 602              		.thumb_func
 604              	HAL_UART_ErrorCallback:
 605              	.LVL42:
 606              	.LFB150:
 147:bsp/usart/bsp_usart.c **** 
 148:bsp/usart/bsp_usart.c **** /**
 149:bsp/usart/bsp_usart.c ****  * @brief å½“ä¸²å£å‘é€/æ¥æ”¶å‡ºç°é”™è¯¯æ—¶,ä¼šè°ƒç”¨æ­¤å‡½æ•°,æ­¤æ—¶è¿™ä¸ªå‡½æ•°è¦åšçš„å°±æ˜
 150:bsp/usart/bsp_usart.c ****  *
 151:bsp/usart/bsp_usart.c ****  * @note  æœ€å¸¸è§çš„é”™è¯¯:å¥‡å¶æ ¡éªŒ/æº¢å‡º/å¸§é”™è¯¯
 152:bsp/usart/bsp_usart.c ****  *
 153:bsp/usart/bsp_usart.c ****  * @param huart å‘ç”Ÿé”™è¯¯çš„ä¸²å£
 154:bsp/usart/bsp_usart.c ****  */
 155:bsp/usart/bsp_usart.c **** void HAL_UART_ErrorCallback(UART_HandleTypeDef *huart)
 156:bsp/usart/bsp_usart.c **** {
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 15


 607              		.loc 1 156 1 view -0
 608              		.cfi_startproc
 609              		@ args = 0, pretend = 0, frame = 0
 610              		@ frame_needed = 0, uses_anonymous_args = 0
 611              		.loc 1 156 1 is_stmt 0 view .LVU149
 612 0000 70B5     		push	{r4, r5, r6, lr}
 613              	.LCFI4:
 614              		.cfi_def_cfa_offset 16
 615              		.cfi_offset 4, -16
 616              		.cfi_offset 5, -12
 617              		.cfi_offset 6, -8
 618              		.cfi_offset 14, -4
 619 0002 0446     		mov	r4, r0
 157:bsp/usart/bsp_usart.c ****     for (uint8_t i = 0; i < usart_instance_idx; ++i)
 620              		.loc 1 157 5 is_stmt 1 view .LVU150
 621              	.LBB5:
 622              		.loc 1 157 10 view .LVU151
 623              	.LVL43:
 624              		.loc 1 157 18 is_stmt 0 view .LVU152
 625 0004 0023     		movs	r3, #0
 626              		.loc 1 157 5 view .LVU153
 627 0006 11E0     		b	.L45
 628              	.LVL44:
 629              	.L52:
 630              	.LBB6:
 158:bsp/usart/bsp_usart.c ****     {
 159:bsp/usart/bsp_usart.c ****         if (huart == usart_instance[i]->usart_handle)
 160:bsp/usart/bsp_usart.c ****         {
 161:bsp/usart/bsp_usart.c ****             uint32_t error = HAL_UART_GetError(huart);
 162:bsp/usart/bsp_usart.c ****             if (error & HAL_UART_ERROR_ORE)
 163:bsp/usart/bsp_usart.c ****             {
 164:bsp/usart/bsp_usart.c ****                 // æº¢å‡ºé”™è¯¯ï¼Œå¯èƒ½éœ€è¦æ¸…ç©ºæ¥æ”¶ç¼“å†²åŒº
 165:bsp/usart/bsp_usart.c ****                 __HAL_UART_CLEAR_OREFLAG(huart);
 631              		.loc 1 165 17 is_stmt 1 view .LVU154
 632 0008 2368     		ldr	r3, [r4]
 633 000a 0822     		movs	r2, #8
 634 000c 1A62     		str	r2, [r3, #32]
 166:bsp/usart/bsp_usart.c ****                 memset(usart_instance[i]->recv_buff, 0, usart_instance[i]->recv_buff_size);
 635              		.loc 1 166 17 view .LVU155
 636              		.loc 1 166 38 is_stmt 0 view .LVU156
 637 000e 164B     		ldr	r3, .L54
 638 0010 53F82530 		ldr	r3, [r3, r5, lsl #2]
 639              		.loc 1 166 17 view .LVU157
 640 0014 5A68     		ldr	r2, [r3, #4]
 641 0016 0021     		movs	r1, #0
 642 0018 1868     		ldr	r0, [r3]
 643              	.LVL45:
 644              		.loc 1 166 17 view .LVU158
 645 001a FFF7FEFF 		bl	memset
 646              	.LVL46:
 647 001e 17E0     		b	.L47
 648              	.L53:
 167:bsp/usart/bsp_usart.c ****             }
 168:bsp/usart/bsp_usart.c **** 
 169:bsp/usart/bsp_usart.c ****             if (error & HAL_UART_ERROR_FE)
 170:bsp/usart/bsp_usart.c ****             {
 171:bsp/usart/bsp_usart.c ****                 // å¸§é”™è¯¯ï¼Œå¯èƒ½éœ€è¦é‡æ–°åŒæ­¥
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 16


 172:bsp/usart/bsp_usart.c ****                 HAL_UART_AbortReceive(huart);
 649              		.loc 1 172 17 is_stmt 1 view .LVU159
 650 0020 2046     		mov	r0, r4
 651 0022 FFF7FEFF 		bl	HAL_UART_AbortReceive
 652              	.LVL47:
 653 0026 16E0     		b	.L48
 654              	.LVL48:
 655              	.L46:
 656              		.loc 1 172 17 is_stmt 0 view .LVU160
 657              	.LBE6:
 157:bsp/usart/bsp_usart.c ****     {
 658              		.loc 1 157 49 is_stmt 1 discriminator 2 view .LVU161
 659 0028 0133     		adds	r3, r3, #1
 660              	.LVL49:
 157:bsp/usart/bsp_usart.c ****     {
 661              		.loc 1 157 49 is_stmt 0 discriminator 2 view .LVU162
 662 002a DBB2     		uxtb	r3, r3
 663              	.LVL50:
 664              	.L45:
 157:bsp/usart/bsp_usart.c ****     {
 665              		.loc 1 157 25 is_stmt 1 discriminator 1 view .LVU163
 157:bsp/usart/bsp_usart.c ****     {
 666              		.loc 1 157 27 is_stmt 0 discriminator 1 view .LVU164
 667 002c 0F4A     		ldr	r2, .L54+4
 668 002e 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 157:bsp/usart/bsp_usart.c ****     {
 669              		.loc 1 157 5 discriminator 1 view .LVU165
 670 0030 9A42     		cmp	r2, r3
 671 0032 18D9     		bls	.L44
 159:bsp/usart/bsp_usart.c ****         {
 672              		.loc 1 159 9 is_stmt 1 view .LVU166
 159:bsp/usart/bsp_usart.c ****         {
 673              		.loc 1 159 36 is_stmt 0 view .LVU167
 674 0034 1D46     		mov	r5, r3
 675 0036 0C4A     		ldr	r2, .L54
 676 0038 52F82320 		ldr	r2, [r2, r3, lsl #2]
 159:bsp/usart/bsp_usart.c ****         {
 677              		.loc 1 159 39 view .LVU168
 678 003c 9268     		ldr	r2, [r2, #8]
 159:bsp/usart/bsp_usart.c ****         {
 679              		.loc 1 159 12 view .LVU169
 680 003e A242     		cmp	r2, r4
 681 0040 F2D1     		bne	.L46
 682              	.LBB7:
 161:bsp/usart/bsp_usart.c ****             if (error & HAL_UART_ERROR_ORE)
 683              		.loc 1 161 13 is_stmt 1 view .LVU170
 161:bsp/usart/bsp_usart.c ****             if (error & HAL_UART_ERROR_ORE)
 684              		.loc 1 161 30 is_stmt 0 view .LVU171
 685 0042 2046     		mov	r0, r4
 686              	.LVL51:
 161:bsp/usart/bsp_usart.c ****             if (error & HAL_UART_ERROR_ORE)
 687              		.loc 1 161 30 view .LVU172
 688 0044 FFF7FEFF 		bl	HAL_UART_GetError
 689              	.LVL52:
 161:bsp/usart/bsp_usart.c ****             if (error & HAL_UART_ERROR_ORE)
 690              		.loc 1 161 30 view .LVU173
 691 0048 0646     		mov	r6, r0
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 17


 692              	.LVL53:
 162:bsp/usart/bsp_usart.c ****             {
 693              		.loc 1 162 13 is_stmt 1 view .LVU174
 162:bsp/usart/bsp_usart.c ****             {
 694              		.loc 1 162 16 is_stmt 0 view .LVU175
 695 004a 10F0080F 		tst	r0, #8
 696 004e DBD1     		bne	.L52
 697              	.LVL54:
 698              	.L47:
 169:bsp/usart/bsp_usart.c ****             {
 699              		.loc 1 169 13 is_stmt 1 view .LVU176
 169:bsp/usart/bsp_usart.c ****             {
 700              		.loc 1 169 16 is_stmt 0 view .LVU177
 701 0050 16F0040F 		tst	r6, #4
 702 0054 E4D1     		bne	.L53
 703              	.L48:
 173:bsp/usart/bsp_usart.c ****             }
 174:bsp/usart/bsp_usart.c **** 
 175:bsp/usart/bsp_usart.c ****             if (error & HAL_UART_ERROR_NE || error & HAL_UART_ERROR_PE)
 704              		.loc 1 175 13 is_stmt 1 view .LVU178
 176:bsp/usart/bsp_usart.c ****             {
 177:bsp/usart/bsp_usart.c ****                 // å™ªå£°é”™è¯¯æˆ–å¥‡å¶æ ¡éªŒé”™è¯¯ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´æ³¢ç‰¹ç‡æˆ–æ ¡éªŒè®¾ç½®
 178:bsp/usart/bsp_usart.c ****                 // è¿™é‡Œä»…è®°å½•ï¼Œå®é™…è°ƒæ•´éœ€è¦æ›´å¤æ‚çš„é€»è¾‘
 179:bsp/usart/bsp_usart.c ****             }
 705              		.loc 1 179 13 view .LVU179
 180:bsp/usart/bsp_usart.c **** 
 181:bsp/usart/bsp_usart.c ****             // HAL_UARTEx_ReceiveToIdle_IT(usart_instance[i]->usart_handle, usart_instance[i]->recv
 182:bsp/usart/bsp_usart.c ****             HAL_UARTEx_ReceiveToIdle_DMA(usart_instance[i]->usart_handle, usart_instance[i]->recv_b
 706              		.loc 1 182 13 view .LVU180
 707              		.loc 1 182 56 is_stmt 0 view .LVU181
 708 0056 044B     		ldr	r3, .L54
 709 0058 53F82530 		ldr	r3, [r3, r5, lsl #2]
 710              		.loc 1 182 13 view .LVU182
 711 005c 9A88     		ldrh	r2, [r3, #4]
 712 005e 1968     		ldr	r1, [r3]
 713 0060 9868     		ldr	r0, [r3, #8]
 714 0062 FFF7FEFF 		bl	HAL_UARTEx_ReceiveToIdle_DMA
 715              	.LVL55:
 183:bsp/usart/bsp_usart.c ****             // __HAL_DMA_DISABLE_IT(usart_instance[i]->usart_handle->hdmarx, DMA_IT_HT);
 184:bsp/usart/bsp_usart.c ****             return;
 716              		.loc 1 184 13 is_stmt 1 view .LVU183
 717              	.L44:
 718              		.loc 1 184 13 is_stmt 0 view .LVU184
 719              	.LBE7:
 720              	.LBE5:
 185:bsp/usart/bsp_usart.c ****         }
 186:bsp/usart/bsp_usart.c ****     }
 187:bsp/usart/bsp_usart.c **** }
 721              		.loc 1 187 1 view .LVU185
 722 0066 70BD     		pop	{r4, r5, r6, pc}
 723              	.LVL56:
 724              	.L55:
 725              		.loc 1 187 1 view .LVU186
 726              		.align	2
 727              	.L54:
 728 0068 00000000 		.word	.LANCHOR2
 729 006c 00000000 		.word	.LANCHOR1
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 18


 730              		.cfi_endproc
 731              	.LFE150:
 733              		.section	.text.VIRTUAL_USARTRegister,"ax",%progbits
 734              		.align	1
 735              		.global	VIRTUAL_USARTRegister
 736              		.syntax unified
 737              		.thumb
 738              		.thumb_func
 740              	VIRTUAL_USARTRegister:
 741              	.LVL57:
 742              	.LFB151:
 188:bsp/usart/bsp_usart.c **** 
 189:bsp/usart/bsp_usart.c **** /*================================VIRTUAL USART==================================*/
 190:bsp/usart/bsp_usart.c **** static uint8_t virtual_instance_idx = 0;
 191:bsp/usart/bsp_usart.c **** 
 192:bsp/usart/bsp_usart.c **** /**
 193:bsp/usart/bsp_usart.c ****  * @brief Virtual usart register
 194:bsp/usart/bsp_usart.c ****  *
 195:bsp/usart/bsp_usart.c ****  */
 196:bsp/usart/bsp_usart.c **** VIRTUALInstance *VIRTUAL_USARTRegister(VIRTUAL_Init_Config_s *init_config)
 197:bsp/usart/bsp_usart.c **** {
 743              		.loc 1 197 1 is_stmt 1 view -0
 744              		.cfi_startproc
 745              		@ args = 0, pretend = 0, frame = 0
 746              		@ frame_needed = 0, uses_anonymous_args = 0
 747              		.loc 1 197 1 is_stmt 0 view .LVU188
 748 0000 70B5     		push	{r4, r5, r6, lr}
 749              	.LCFI5:
 750              		.cfi_def_cfa_offset 16
 751              		.cfi_offset 4, -16
 752              		.cfi_offset 5, -12
 753              		.cfi_offset 6, -8
 754              		.cfi_offset 14, -4
 198:bsp/usart/bsp_usart.c ****     if (virtual_instance_idx > DEVICE_VIRTUAL_CNT)
 755              		.loc 1 198 5 is_stmt 1 view .LVU189
 756              		.loc 1 198 30 is_stmt 0 view .LVU190
 757 0002 124B     		ldr	r3, .L60
 758 0004 1D78     		ldrb	r5, [r3]	@ zero_extendqisi2
 759              		.loc 1 198 8 view .LVU191
 760 0006 012D     		cmp	r5, #1
 761 0008 00D9     		bls	.L57
 762              	.L58:
 199:bsp/usart/bsp_usart.c ****         while (1)
 763              		.loc 1 199 9 is_stmt 1 discriminator 1 view .LVU192
 200:bsp/usart/bsp_usart.c ****             ;
 764              		.loc 1 200 13 discriminator 1 view .LVU193
 199:bsp/usart/bsp_usart.c ****         while (1)
 765              		.loc 1 199 15 discriminator 1 view .LVU194
 766 000a FEE7     		b	.L58
 767              	.L57:
 768 000c 0446     		mov	r4, r0
 201:bsp/usart/bsp_usart.c ****     VIRTUALInstance *instance = (VIRTUALInstance *)malloc(sizeof(VIRTUALInstance));
 769              		.loc 1 201 5 view .LVU195
 770              		.loc 1 201 52 is_stmt 0 view .LVU196
 771 000e 1820     		movs	r0, #24
 772              	.LVL58:
 773              		.loc 1 201 52 view .LVU197
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 19


 774 0010 FFF7FEFF 		bl	malloc
 775              	.LVL59:
 776 0014 0646     		mov	r6, r0
 777              	.LVL60:
 202:bsp/usart/bsp_usart.c ****     memset(instance, 0, sizeof(VIRTUALInstance));
 778              		.loc 1 202 5 is_stmt 1 view .LVU198
 779 0016 0023     		movs	r3, #0
 780 0018 0360     		str	r3, [r0]	@ unaligned
 781 001a 4360     		str	r3, [r0, #4]	@ unaligned
 782 001c 8360     		str	r3, [r0, #8]	@ unaligned
 783 001e C360     		str	r3, [r0, #12]	@ unaligned
 784 0020 0361     		str	r3, [r0, #16]	@ unaligned
 785 0022 4361     		str	r3, [r0, #20]	@ unaligned
 203:bsp/usart/bsp_usart.c **** 
 204:bsp/usart/bsp_usart.c ****     instance->tx_pin = init_config->tx_pin;
 786              		.loc 1 204 5 view .LVU199
 787              		.loc 1 204 35 is_stmt 0 view .LVU200
 788 0024 2389     		ldrh	r3, [r4, #8]
 789              		.loc 1 204 22 view .LVU201
 790 0026 0381     		strh	r3, [r0, #8]	@ movhi
 205:bsp/usart/bsp_usart.c ****     instance->rx_pin = init_config->rx_pin;
 791              		.loc 1 205 5 is_stmt 1 view .LVU202
 792              		.loc 1 205 35 is_stmt 0 view .LVU203
 793 0028 6389     		ldrh	r3, [r4, #10]
 794              		.loc 1 205 22 view .LVU204
 795 002a 4381     		strh	r3, [r0, #10]	@ movhi
 206:bsp/usart/bsp_usart.c ****     instance->tx_port = init_config->tx_port;
 796              		.loc 1 206 5 is_stmt 1 view .LVU205
 797              		.loc 1 206 36 is_stmt 0 view .LVU206
 798 002c 2368     		ldr	r3, [r4]
 799              		.loc 1 206 23 view .LVU207
 800 002e 0360     		str	r3, [r0]
 207:bsp/usart/bsp_usart.c ****     instance->rx_port = init_config->rx_port;
 801              		.loc 1 207 5 is_stmt 1 view .LVU208
 802              		.loc 1 207 36 is_stmt 0 view .LVU209
 803 0030 6368     		ldr	r3, [r4, #4]
 804              		.loc 1 207 23 view .LVU210
 805 0032 4360     		str	r3, [r0, #4]
 208:bsp/usart/bsp_usart.c ****     instance->recv_buff_size = init_config->recv_buff_size;
 806              		.loc 1 208 5 is_stmt 1 view .LVU211
 807              		.loc 1 208 43 is_stmt 0 view .LVU212
 808 0034 E068     		ldr	r0, [r4, #12]
 809              	.LVL61:
 810              		.loc 1 208 30 view .LVU213
 811 0036 F060     		str	r0, [r6, #12]
 209:bsp/usart/bsp_usart.c ****     instance->recv_buff = (uint8_t *)malloc(init_config->recv_buff_size);
 812              		.loc 1 209 5 is_stmt 1 view .LVU214
 813              		.loc 1 209 38 is_stmt 0 view .LVU215
 814 0038 FFF7FEFF 		bl	malloc
 815              	.LVL62:
 816              		.loc 1 209 25 view .LVU216
 817 003c 3061     		str	r0, [r6, #16]
 210:bsp/usart/bsp_usart.c ****     instance->trans_baud = init_config->trans_baud;
 818              		.loc 1 210 5 is_stmt 1 view .LVU217
 819              		.loc 1 210 39 is_stmt 0 view .LVU218
 820 003e 238A     		ldrh	r3, [r4, #16]
 821              		.loc 1 210 26 view .LVU219
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 20


 822 0040 B382     		strh	r3, [r6, #20]	@ movhi
 211:bsp/usart/bsp_usart.c **** 
 212:bsp/usart/bsp_usart.c ****     virtual_instance_idx++;
 823              		.loc 1 212 5 is_stmt 1 view .LVU220
 824              		.loc 1 212 25 is_stmt 0 view .LVU221
 825 0042 0135     		adds	r5, r5, #1
 826 0044 014B     		ldr	r3, .L60
 827 0046 1D70     		strb	r5, [r3]
 213:bsp/usart/bsp_usart.c ****     return instance;
 828              		.loc 1 213 5 is_stmt 1 view .LVU222
 214:bsp/usart/bsp_usart.c **** }
 829              		.loc 1 214 1 is_stmt 0 view .LVU223
 830 0048 3046     		mov	r0, r6
 831 004a 70BD     		pop	{r4, r5, r6, pc}
 832              	.LVL63:
 833              	.L61:
 834              		.loc 1 214 1 view .LVU224
 835              		.align	2
 836              	.L60:
 837 004c 00000000 		.word	.LANCHOR3
 838              		.cfi_endproc
 839              	.LFE151:
 841              		.section	.text.VirtualCOM_ByteSend,"ax",%progbits
 842              		.align	1
 843              		.global	VirtualCOM_ByteSend
 844              		.syntax unified
 845              		.thumb
 846              		.thumb_func
 848              	VirtualCOM_ByteSend:
 849              	.LVL64:
 850              	.LFB152:
 215:bsp/usart/bsp_usart.c **** 
 216:bsp/usart/bsp_usart.c **** /* @todo åœ¨å®ç°freertosä¹‹åè¡¥å……delay_usçš„å®ç° */
 217:bsp/usart/bsp_usart.c **** void VirtualCOM_ByteSend(VIRTUALInstance *instance, uint8_t data)
 218:bsp/usart/bsp_usart.c **** {
 851              		.loc 1 218 1 is_stmt 1 view -0
 852              		.cfi_startproc
 853              		@ args = 0, pretend = 0, frame = 0
 854              		@ frame_needed = 0, uses_anonymous_args = 0
 855              		.loc 1 218 1 is_stmt 0 view .LVU226
 856 0000 70B5     		push	{r4, r5, r6, lr}
 857              	.LCFI6:
 858              		.cfi_def_cfa_offset 16
 859              		.cfi_offset 4, -16
 860              		.cfi_offset 5, -12
 861              		.cfi_offset 6, -8
 862              		.cfi_offset 14, -4
 863 0002 0546     		mov	r5, r0
 864 0004 0E46     		mov	r6, r1
 219:bsp/usart/bsp_usart.c ****     uint8_t i;
 865              		.loc 1 219 5 is_stmt 1 view .LVU227
 220:bsp/usart/bsp_usart.c ****     HAL_GPIO_WritePin(instance->tx_port, instance->tx_pin, GPIO_PIN_RESET); // å‘é€èµ·å§‹ä½
 866              		.loc 1 220 5 view .LVU228
 867 0006 0022     		movs	r2, #0
 868 0008 0189     		ldrh	r1, [r0, #8]
 869              	.LVL65:
 870              		.loc 1 220 5 is_stmt 0 view .LVU229
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 21


 871 000a 0068     		ldr	r0, [r0]
 872              	.LVL66:
 873              		.loc 1 220 5 view .LVU230
 874 000c FFF7FEFF 		bl	HAL_GPIO_WritePin
 875              	.LVL67:
 221:bsp/usart/bsp_usart.c ****     // delay_us(instance->trans_baud); // after freertos
 222:bsp/usart/bsp_usart.c ****     for (i = 0; i < 8; i++) // å‘é€8ä½æ•°æ®ä½
 876              		.loc 1 222 5 is_stmt 1 view .LVU231
 877              		.loc 1 222 12 is_stmt 0 view .LVU232
 878 0010 0024     		movs	r4, #0
 879              		.loc 1 222 5 view .LVU233
 880 0012 0EE0     		b	.L63
 881              	.LVL68:
 882              	.L64:
 223:bsp/usart/bsp_usart.c ****     {
 224:bsp/usart/bsp_usart.c ****         if (data & 0x01)
 225:bsp/usart/bsp_usart.c ****             HAL_GPIO_WritePin(instance->tx_port, instance->tx_pin, GPIO_PIN_SET); // 1
 226:bsp/usart/bsp_usart.c ****         else
 227:bsp/usart/bsp_usart.c ****             HAL_GPIO_WritePin(instance->tx_port, instance->tx_pin, GPIO_PIN_RESET); // 0
 883              		.loc 1 227 13 is_stmt 1 view .LVU234
 884 0014 0022     		movs	r2, #0
 885 0016 2989     		ldrh	r1, [r5, #8]
 886 0018 2868     		ldr	r0, [r5]
 887 001a FFF7FEFF 		bl	HAL_GPIO_WritePin
 888              	.LVL69:
 889              	.L65:
 228:bsp/usart/bsp_usart.c ****         data >>= 1;
 890              		.loc 1 228 9 discriminator 2 view .LVU235
 891              		.loc 1 228 14 is_stmt 0 discriminator 2 view .LVU236
 892 001e 7608     		lsrs	r6, r6, #1
 893              	.LVL70:
 229:bsp/usart/bsp_usart.c ****         DWT_Delay_us(instance->trans_baud);
 894              		.loc 1 229 9 is_stmt 1 discriminator 2 view .LVU237
 895              		.loc 1 229 30 is_stmt 0 discriminator 2 view .LVU238
 896 0020 AB8A     		ldrh	r3, [r5, #20]
 897 0022 00EE103A 		vmov	s0, r3	@ int
 898              		.loc 1 229 9 discriminator 2 view .LVU239
 899 0026 B8EE400A 		vcvt.f32.u32	s0, s0
 900 002a FFF7FEFF 		bl	DWT_Delay_us
 901              	.LVL71:
 222:bsp/usart/bsp_usart.c ****     {
 902              		.loc 1 222 24 is_stmt 1 discriminator 2 view .LVU240
 222:bsp/usart/bsp_usart.c ****     {
 903              		.loc 1 222 25 is_stmt 0 discriminator 2 view .LVU241
 904 002e 0134     		adds	r4, r4, #1
 905              	.LVL72:
 222:bsp/usart/bsp_usart.c ****     {
 906              		.loc 1 222 25 discriminator 2 view .LVU242
 907 0030 E4B2     		uxtb	r4, r4
 908              	.LVL73:
 909              	.L63:
 222:bsp/usart/bsp_usart.c ****     {
 910              		.loc 1 222 17 is_stmt 1 discriminator 1 view .LVU243
 222:bsp/usart/bsp_usart.c ****     {
 911              		.loc 1 222 5 is_stmt 0 discriminator 1 view .LVU244
 912 0032 072C     		cmp	r4, #7
 913 0034 08D8     		bhi	.L68
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 22


 224:bsp/usart/bsp_usart.c ****             HAL_GPIO_WritePin(instance->tx_port, instance->tx_pin, GPIO_PIN_SET); // 1
 914              		.loc 1 224 9 is_stmt 1 view .LVU245
 224:bsp/usart/bsp_usart.c ****             HAL_GPIO_WritePin(instance->tx_port, instance->tx_pin, GPIO_PIN_SET); // 1
 915              		.loc 1 224 12 is_stmt 0 view .LVU246
 916 0036 16F0010F 		tst	r6, #1
 917 003a EBD0     		beq	.L64
 225:bsp/usart/bsp_usart.c ****         else
 918              		.loc 1 225 13 is_stmt 1 view .LVU247
 919 003c 0122     		movs	r2, #1
 920 003e 2989     		ldrh	r1, [r5, #8]
 921 0040 2868     		ldr	r0, [r5]
 922 0042 FFF7FEFF 		bl	HAL_GPIO_WritePin
 923              	.LVL74:
 924 0046 EAE7     		b	.L65
 925              	.L68:
 230:bsp/usart/bsp_usart.c ****         // delay_us(instance->trans_baud); // after freertos
 231:bsp/usart/bsp_usart.c ****     }
 232:bsp/usart/bsp_usart.c ****     HAL_GPIO_WritePin(instance->tx_port, instance->tx_pin, GPIO_PIN_SET); // å‘é€ç»“æŸä½
 926              		.loc 1 232 5 view .LVU248
 927 0048 0122     		movs	r2, #1
 928 004a 2989     		ldrh	r1, [r5, #8]
 929 004c 2868     		ldr	r0, [r5]
 930 004e FFF7FEFF 		bl	HAL_GPIO_WritePin
 931              	.LVL75:
 233:bsp/usart/bsp_usart.c ****     DWT_Delay_us(instance->trans_baud);
 932              		.loc 1 233 5 view .LVU249
 933              		.loc 1 233 26 is_stmt 0 view .LVU250
 934 0052 AB8A     		ldrh	r3, [r5, #20]
 935 0054 00EE103A 		vmov	s0, r3	@ int
 936              		.loc 1 233 5 view .LVU251
 937 0058 B8EE400A 		vcvt.f32.u32	s0, s0
 938 005c FFF7FEFF 		bl	DWT_Delay_us
 939              	.LVL76:
 234:bsp/usart/bsp_usart.c ****     // delay_us(instance->trans_baud); // after freertos
 235:bsp/usart/bsp_usart.c **** }
 940              		.loc 1 235 1 view .LVU252
 941 0060 70BD     		pop	{r4, r5, r6, pc}
 942              		.loc 1 235 1 view .LVU253
 943              		.cfi_endproc
 944              	.LFE152:
 946              		.section	.text.VirtualCOM_SendArr,"ax",%progbits
 947              		.align	1
 948              		.global	VirtualCOM_SendArr
 949              		.syntax unified
 950              		.thumb
 951              		.thumb_func
 953              	VirtualCOM_SendArr:
 954              	.LVL77:
 955              	.LFB153:
 236:bsp/usart/bsp_usart.c **** 
 237:bsp/usart/bsp_usart.c **** void VirtualCOM_SendArr(VIRTUALInstance *instance, uint8_t *arr, size_t arr_len)
 238:bsp/usart/bsp_usart.c **** {
 956              		.loc 1 238 1 is_stmt 1 view -0
 957              		.cfi_startproc
 958              		@ args = 0, pretend = 0, frame = 0
 959              		@ frame_needed = 0, uses_anonymous_args = 0
 960              		.loc 1 238 1 is_stmt 0 view .LVU255
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 23


 961 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 962              	.LCFI7:
 963              		.cfi_def_cfa_offset 24
 964              		.cfi_offset 3, -24
 965              		.cfi_offset 4, -20
 966              		.cfi_offset 5, -16
 967              		.cfi_offset 6, -12
 968              		.cfi_offset 7, -8
 969              		.cfi_offset 14, -4
 970 0002 0746     		mov	r7, r0
 971 0004 0E46     		mov	r6, r1
 972 0006 1546     		mov	r5, r2
 239:bsp/usart/bsp_usart.c ****     for (size_t i = 0; i < arr_len; i++)
 973              		.loc 1 239 5 is_stmt 1 view .LVU256
 974              	.LBB8:
 975              		.loc 1 239 10 view .LVU257
 976              	.LVL78:
 977              		.loc 1 239 17 is_stmt 0 view .LVU258
 978 0008 0024     		movs	r4, #0
 979              		.loc 1 239 5 view .LVU259
 980 000a 04E0     		b	.L70
 981              	.LVL79:
 982              	.L71:
 240:bsp/usart/bsp_usart.c ****     {
 241:bsp/usart/bsp_usart.c ****         VirtualCOM_ByteSend(instance, arr[i]);
 983              		.loc 1 241 9 is_stmt 1 discriminator 3 view .LVU260
 984 000c 315D     		ldrb	r1, [r6, r4]	@ zero_extendqisi2
 985 000e 3846     		mov	r0, r7
 986 0010 FFF7FEFF 		bl	VirtualCOM_ByteSend
 987              	.LVL80:
 239:bsp/usart/bsp_usart.c ****     for (size_t i = 0; i < arr_len; i++)
 988              		.loc 1 239 37 discriminator 3 view .LVU261
 239:bsp/usart/bsp_usart.c ****     for (size_t i = 0; i < arr_len; i++)
 989              		.loc 1 239 38 is_stmt 0 discriminator 3 view .LVU262
 990 0014 0134     		adds	r4, r4, #1
 991              	.LVL81:
 992              	.L70:
 239:bsp/usart/bsp_usart.c ****     for (size_t i = 0; i < arr_len; i++)
 993              		.loc 1 239 24 is_stmt 1 discriminator 1 view .LVU263
 239:bsp/usart/bsp_usart.c ****     for (size_t i = 0; i < arr_len; i++)
 994              		.loc 1 239 5 is_stmt 0 discriminator 1 view .LVU264
 995 0016 AC42     		cmp	r4, r5
 996 0018 F8D3     		bcc	.L71
 997              	.LBE8:
 242:bsp/usart/bsp_usart.c ****     }
 243:bsp/usart/bsp_usart.c **** }...
 998              		.loc 1 243 1 view .LVU265
 999 001a F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1000              		.loc 1 243 1 view .LVU266
 1001              		.cfi_endproc
 1002              	.LFE153:
 1004              		.section	.bss.my_section_offset,"aw",%nobits
 1005              		.align	2
 1006              		.set	.LANCHOR0,. + 0
 1009              	my_section_offset:
 1010 0000 00000000 		.space	4
 1011              		.section	.bss.usart_instance,"aw",%nobits
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 24


 1012              		.align	2
 1013              		.set	.LANCHOR2,. + 0
 1016              	usart_instance:
 1017 0000 00000000 		.space	20
 1017      00000000 
 1017      00000000 
 1017      00000000 
 1017      00000000 
 1018              		.section	.bss.usart_instance_idx,"aw",%nobits
 1019              		.set	.LANCHOR1,. + 0
 1022              	usart_instance_idx:
 1023 0000 00       		.space	1
 1024              		.section	.bss.virtual_instance_idx,"aw",%nobits
 1025              		.set	.LANCHOR3,. + 0
 1028              	virtual_instance_idx:
 1029 0000 00       		.space	1
 1030              		.section	.my_section,"aw"
 1031              		.align	2
 1034              	my_section:
 1035 0000 00000000 		.space	4096
 1035      00000000 
 1035      00000000 
 1035      00000000 
 1035      00000000 
 1036              		.text
 1037              	.Letext0:
 1038              		.file 2 "d:\\rm\\arm-gnu-toolchian\\arm-none-eabi\\include\\machine\\_default_types.h"
 1039              		.file 3 "d:\\rm\\arm-gnu-toolchian\\arm-none-eabi\\include\\sys\\_stdint.h"
 1040              		.file 4 "Drivers/CMSIS/Device/ST/STM32H7xx/Include/stm32h743xx.h"
 1041              		.file 5 "d:\\rm\\arm-gnu-toolchian\\lib\\gcc\\arm-none-eabi\\10.3.1\\include\\stddef.h"
 1042              		.file 6 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_def.h"
 1043              		.file 7 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_gpio.h"
 1044              		.file 8 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_dma.h"
 1045              		.file 9 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_uart.h"
 1046              		.file 10 "bsp/usart/bsp_usart.h"
 1047              		.file 11 "bsp/dwt/bsp_dwt.h"
 1048              		.file 12 "d:\\rm\\arm-gnu-toolchian\\arm-none-eabi\\include\\stdlib.h"
 1049              		.file 13 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_uart_ex.h"
 1050              		.file 14 "<built-in>"
ARM GAS  C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s 			page 25


DEFINED SYMBOLS
                            *ABS*:00000000 bsp_usart.c
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:19     .text.my_malloc:00000000 $t
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:25     .text.my_malloc:00000000 my_malloc
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:65     .text.my_malloc:00000018 $d
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:1034   .my_section:00000000 my_section
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:71     .text.USARTServiceInit:00000000 $t
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:77     .text.USARTServiceInit:00000000 USARTServiceInit
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:184    .text.USARTServiceInit:0000008c $d
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:190    .text.USARTRegister:00000000 $t
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:196    .text.USARTRegister:00000000 USARTRegister
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:323    .text.USARTRegister:00000068 $d
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:329    .text.USARTSend:00000000 $t
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:335    .text.USARTSend:00000000 USARTSend
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:398    .text.USARTIsReady:00000000 $t
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:404    .text.USARTIsReady:00000000 USARTIsReady
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:427    .text.HAL_UARTEx_RxEventCallback:00000000 $t
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:433    .text.HAL_UARTEx_RxEventCallback:00000000 HAL_UARTEx_RxEventCallback
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:589    .text.HAL_UARTEx_RxEventCallback:000000b8 $d
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:598    .text.HAL_UART_ErrorCallback:00000000 $t
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:604    .text.HAL_UART_ErrorCallback:00000000 HAL_UART_ErrorCallback
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:728    .text.HAL_UART_ErrorCallback:00000068 $d
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:734    .text.VIRTUAL_USARTRegister:00000000 $t
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:740    .text.VIRTUAL_USARTRegister:00000000 VIRTUAL_USARTRegister
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:837    .text.VIRTUAL_USARTRegister:0000004c $d
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:842    .text.VirtualCOM_ByteSend:00000000 $t
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:848    .text.VirtualCOM_ByteSend:00000000 VirtualCOM_ByteSend
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:947    .text.VirtualCOM_SendArr:00000000 $t
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:953    .text.VirtualCOM_SendArr:00000000 VirtualCOM_SendArr
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:1005   .bss.my_section_offset:00000000 $d
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:1009   .bss.my_section_offset:00000000 my_section_offset
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:1012   .bss.usart_instance:00000000 $d
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:1016   .bss.usart_instance:00000000 usart_instance
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:1022   .bss.usart_instance_idx:00000000 usart_instance_idx
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:1023   .bss.usart_instance_idx:00000000 $d
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:1028   .bss.virtual_instance_idx:00000000 virtual_instance_idx
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:1029   .bss.virtual_instance_idx:00000000 $d
C:\Users\blue\AppData\Local\Temp\cc5X9tFR.s:1031   .my_section:00000000 $d

UNDEFINED SYMBOLS
HAL_UARTEx_ReceiveToIdle_DMA
malloc
HAL_UART_Transmit
HAL_UART_Transmit_IT
HAL_UART_Transmit_DMA
memset
HAL_UART_AbortReceive
HAL_UART_GetError
HAL_GPIO_WritePin
DWT_Delay_us
