ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 1


   1              		.cpu cortex-m7
   2              		.arch armv7e-m
   3              		.fpu fpv5-d16
   4              		.eabi_attribute 28, 1
   5              		.eabi_attribute 20, 1
   6              		.eabi_attribute 21, 1
   7              		.eabi_attribute 23, 3
   8              		.eabi_attribute 24, 1
   9              		.eabi_attribute 25, 1
  10              		.eabi_attribute 26, 1
  11              		.eabi_attribute 30, 1
  12              		.eabi_attribute 34, 1
  13              		.eabi_attribute 18, 4
  14              		.file	"bsp_can.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.CANServiceInit,"ax",%progbits
  19              		.align	1
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  24              	CANServiceInit:
  25              	.LFB145:
  26              		.file 1 "bsp/can/bsp_can.c"
   1:bsp/can/bsp_can.c **** #include "bsp_can.h"
   2:bsp/can/bsp_can.c **** #include "main.h"
   3:bsp/can/bsp_can.c **** #include "memory.h"
   4:bsp/can/bsp_can.c **** #include "stdlib.h"
   5:bsp/can/bsp_can.c **** #include "bsp_dwt.h"
   6:bsp/can/bsp_can.c **** // #include "bsp_log.h"
   7:bsp/can/bsp_can.c **** /* can instance ptrs storage, used for recv callback */
   8:bsp/can/bsp_can.c **** // åœ¨CANäº§ç”Ÿæ¥æ”¶ä¸­æ–­ä¼šéå†æ•°ç»„,é€‰å‡ºhcanå’Œrxidä¸å‘ç”Ÿä¸­æ–­çš„å®ä¾‹ç›¸åŒçš„é‚£ä¸ª
   9:bsp/can/bsp_can.c **** // @todo: åç»­ä¸ºæ¯ä¸ªCANæ€»çº¿å•ç‹¬æ·»åŠ ä¸€ä¸ªcan_instanceæŒ‡é’ˆæ•°ç»„,æé«˜å›è°ƒæŸ¥æ‰¾çš„æ
  10:bsp/can/bsp_can.c **** static CANInstance *can_instance[CAN_MX_REGISTER_CNT] = {NULL};
  11:bsp/can/bsp_can.c **** static uint8_t idx; // å…¨å±€CANå®ä¾‹ç´¢å¼•,æ¯æ¬¡æœ‰æ–°çš„æ¨¡å—æ³¨å†Œä¼šè‡ªå¢
  12:bsp/can/bsp_can.c **** 
  13:bsp/can/bsp_can.c **** /* ----------------two static function called by CANRegister()-------------------- */
  14:bsp/can/bsp_can.c **** 
  15:bsp/can/bsp_can.c **** /**
  16:bsp/can/bsp_can.c ****  * @brief æ·»åŠ è¿‡æ»¤å™¨ä»¥å®ç°å¯¹ç‰¹å®šidçš„æŠ¥æ–‡çš„æ¥æ”¶,ä¼šè¢«CANRegister()è°ƒç”¨
  17:bsp/can/bsp_can.c ****  *        ç»™CANæ·»åŠ è¿‡æ»¤å™¨å,BxCANä¼šæ ¹æ®æ¥æ”¶åˆ°çš„æŠ¥æ–‡çš„idè¿›è¡Œæ¶ˆæ¯è¿‡æ»¤,ç¬¦åˆè§
  18:bsp/can/bsp_can.c ****  *
  19:bsp/can/bsp_can.c ****  * @note f407çš„bxCANæœ‰28ä¸ªè¿‡æ»¤å™¨,è¿™é‡Œå°†å…¶é…ç½®ä¸ºå‰14ä¸ªè¿‡æ»¤å™¨ç»™CAN1ä½¿ç”¨,å14ä¸ª
  20:bsp/can/bsp_can.c ****  *       åˆå§‹åŒ–æ—¶,å¥‡æ•°idçš„æ¨¡å—ä¼šè¢«åˆ†é…åˆ°FIFO0,å¶æ•°idçš„æ¨¡å—ä¼šè¢«åˆ†é…åˆ°FIFO1
  21:bsp/can/bsp_can.c ****  *       æ³¨å†Œåˆ°CAN1çš„æ¨¡å—ä½¿ç”¨è¿‡æ»¤å™¨0-13,CAN2ä½¿ç”¨è¿‡æ»¤å™¨14-27
  22:bsp/can/bsp_can.c ****  *
  23:bsp/can/bsp_can.c ****  * @attention ä½ ä¸éœ€è¦å®Œå…¨ç†è§£è¿™ä¸ªå‡½æ•°çš„ä½œç”¨,å› ä¸ºå®ƒä¸»è¦æ˜¯ç”¨äºåˆå§‹åŒ–,åœ¨å¼
  24:bsp/can/bsp_can.c ****  *            äº«å—å¼€å‘çš„ä¹è¶£å§!å¦‚æœä½ çœŸçš„æƒ³çŸ¥é“è¿™ä¸ªå‡½æ•°åœ¨å¹²ä»€ä¹ˆ,è¯·è”ç³»ä½
  25:bsp/can/bsp_can.c ****  *
  26:bsp/can/bsp_can.c ****  * @param _instance can instance owned by specific module
  27:bsp/can/bsp_can.c ****  */
  28:bsp/can/bsp_can.c **** static void CANAddFilter(CANInstance *_instance)
  29:bsp/can/bsp_can.c **** {
  30:bsp/can/bsp_can.c ****     FDCAN_FilterTypeDef can_filter_conf;
  31:bsp/can/bsp_can.c ****     static uint8_t can1_filter_idx = 0, can2_filter_idx = 14; // 0-13ç»™can1ç”¨,14-27ç»™can2ç”¨
  32:bsp/can/bsp_can.c **** 
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 2


  33:bsp/can/bsp_can.c ****     can_filter_conf.IdType = FDCAN_STANDARD_ID;
  34:bsp/can/bsp_can.c ****     can_filter_conf.FilterType = FDCAN_FILTER_MASK;
  35:bsp/can/bsp_can.c ****     can_filter_conf.FilterConfig = (_instance->tx_id & 1) ? FDCAN_FILTER_TO_RXFIFO0 : FDCAN_FILTER_
  36:bsp/can/bsp_can.c ****     can_filter_conf.FilterID1 = _instance->rx_id;
  37:bsp/can/bsp_can.c ****     can_filter_conf.FilterID2 = 0x7FF;
  38:bsp/can/bsp_can.c ****     can_filter_conf.RxBufferIndex = (_instance->can_handle == &hfdcan1) ? can1_filter_idx++ : can2_
  39:bsp/can/bsp_can.c ****     can_filter_conf.IsCalibrationMsg = 0;
  40:bsp/can/bsp_can.c ****     HAL_FDCAN_ConfigFilter(_instance->can_handle, &can_filter_conf);
  41:bsp/can/bsp_can.c **** }
  42:bsp/can/bsp_can.c **** 
  43:bsp/can/bsp_can.c **** /**
  44:bsp/can/bsp_can.c ****  * @brief åœ¨ç¬¬ä¸€ä¸ªCANå®ä¾‹åˆå§‹åŒ–çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨æ­¤å‡½æ•°,å¯åŠ¨CANæœåŠ¡
  45:bsp/can/bsp_can.c ****  *
  46:bsp/can/bsp_can.c ****  * @note æ­¤å‡½æ•°ä¼šå¯åŠ¨CAN1å’ŒCAN2,å¼€å¯CAN1å’ŒCAN2çš„FIFO0 & FIFO1æº¢å‡ºé€šçŸ¥
  47:bsp/can/bsp_can.c ****  *
  48:bsp/can/bsp_can.c ****  */
  49:bsp/can/bsp_can.c **** static void CANServiceInit()
  50:bsp/can/bsp_can.c **** {
  27              		.loc 1 50 1 view -0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31 0000 10B5     		push	{r4, lr}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 8
  34              		.cfi_offset 4, -8
  35              		.cfi_offset 14, -4
  51:bsp/can/bsp_can.c ****     HAL_FDCAN_Start(&hfdcan1);
  36              		.loc 1 51 5 view .LVU1
  37 0002 074C     		ldr	r4, .L3
  38 0004 2046     		mov	r0, r4
  39 0006 FFF7FEFF 		bl	HAL_FDCAN_Start
  40              	.LVL0:
  52:bsp/can/bsp_can.c ****     HAL_FDCAN_ActivateNotification(&hfdcan1, FDCAN_IT_RX_FIFO0_NEW_MESSAGE, 0);
  41              		.loc 1 52 5 view .LVU2
  42 000a 0022     		movs	r2, #0
  43 000c 0121     		movs	r1, #1
  44 000e 2046     		mov	r0, r4
  45 0010 FFF7FEFF 		bl	HAL_FDCAN_ActivateNotification
  46              	.LVL1:
  53:bsp/can/bsp_can.c ****     HAL_FDCAN_ActivateNotification(&hfdcan1, FDCAN_IT_RX_FIFO1_NEW_MESSAGE, 0);
  47              		.loc 1 53 5 view .LVU3
  48 0014 0022     		movs	r2, #0
  49 0016 1021     		movs	r1, #16
  50 0018 2046     		mov	r0, r4
  51 001a FFF7FEFF 		bl	HAL_FDCAN_ActivateNotification
  52              	.LVL2:
  54:bsp/can/bsp_can.c ****     // HAL_FDCAN_Start(&hfdcan2);
  55:bsp/can/bsp_can.c ****     // HAL_FDCAN_ActivateNotification(&hfdcan2, FDCAN_IT_RX_FIFO0_NEW_MESSAGE, 0);
  56:bsp/can/bsp_can.c ****     // HAL_FDCAN_ActivateNotification(&hfdcan2, FDCAN_IT_RX_FIFO1_NEW_MESSAGE, 0);
  57:bsp/can/bsp_can.c **** }
  53              		.loc 1 57 1 is_stmt 0 view .LVU4
  54 001e 10BD     		pop	{r4, pc}
  55              	.L4:
  56              		.align	2
  57              	.L3:
  58 0020 00000000 		.word	hfdcan1
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 3


  59              		.cfi_endproc
  60              	.LFE145:
  62              		.section	.text.CANAddFilter,"ax",%progbits
  63              		.align	1
  64              		.syntax unified
  65              		.thumb
  66              		.thumb_func
  68              	CANAddFilter:
  69              	.LVL3:
  70              	.LFB144:
  29:bsp/can/bsp_can.c ****     FDCAN_FilterTypeDef can_filter_conf;
  71              		.loc 1 29 1 is_stmt 1 view -0
  72              		.cfi_startproc
  73              		@ args = 0, pretend = 0, frame = 32
  74              		@ frame_needed = 0, uses_anonymous_args = 0
  29:bsp/can/bsp_can.c ****     FDCAN_FilterTypeDef can_filter_conf;
  75              		.loc 1 29 1 is_stmt 0 view .LVU6
  76 0000 00B5     		push	{lr}
  77              	.LCFI1:
  78              		.cfi_def_cfa_offset 4
  79              		.cfi_offset 14, -4
  80 0002 89B0     		sub	sp, sp, #36
  81              	.LCFI2:
  82              		.cfi_def_cfa_offset 40
  30:bsp/can/bsp_can.c ****     static uint8_t can1_filter_idx = 0, can2_filter_idx = 14; // 0-13ç»™can1ç”¨,14-27ç»™can2ç”¨
  83              		.loc 1 30 5 is_stmt 1 view .LVU7
  31:bsp/can/bsp_can.c **** 
  84              		.loc 1 31 5 view .LVU8
  33:bsp/can/bsp_can.c ****     can_filter_conf.FilterType = FDCAN_FILTER_MASK;
  85              		.loc 1 33 5 view .LVU9
  33:bsp/can/bsp_can.c ****     can_filter_conf.FilterType = FDCAN_FILTER_MASK;
  86              		.loc 1 33 28 is_stmt 0 view .LVU10
  87 0004 0023     		movs	r3, #0
  88 0006 0093     		str	r3, [sp]
  34:bsp/can/bsp_can.c ****     can_filter_conf.FilterConfig = (_instance->tx_id & 1) ? FDCAN_FILTER_TO_RXFIFO0 : FDCAN_FILTER_
  89              		.loc 1 34 5 is_stmt 1 view .LVU11
  34:bsp/can/bsp_can.c ****     can_filter_conf.FilterConfig = (_instance->tx_id & 1) ? FDCAN_FILTER_TO_RXFIFO0 : FDCAN_FILTER_
  90              		.loc 1 34 32 is_stmt 0 view .LVU12
  91 0008 0223     		movs	r3, #2
  92 000a 0293     		str	r3, [sp, #8]
  35:bsp/can/bsp_can.c ****     can_filter_conf.FilterID1 = _instance->rx_id;
  93              		.loc 1 35 5 is_stmt 1 view .LVU13
  35:bsp/can/bsp_can.c ****     can_filter_conf.FilterID1 = _instance->rx_id;
  94              		.loc 1 35 46 is_stmt 0 view .LVU14
  95 000c 836A     		ldr	r3, [r0, #40]	@ unaligned
  35:bsp/can/bsp_can.c ****     can_filter_conf.FilterID1 = _instance->rx_id;
  96              		.loc 1 35 85 view .LVU15
  97 000e 13F0010F 		tst	r3, #1
  98 0012 18D0     		beq	.L9
  99 0014 0123     		movs	r3, #1
 100              	.L6:
  35:bsp/can/bsp_can.c ****     can_filter_conf.FilterID1 = _instance->rx_id;
 101              		.loc 1 35 34 discriminator 4 view .LVU16
 102 0016 0393     		str	r3, [sp, #12]
  36:bsp/can/bsp_can.c ****     can_filter_conf.FilterID2 = 0x7FF;
 103              		.loc 1 36 5 is_stmt 1 discriminator 4 view .LVU17
  36:bsp/can/bsp_can.c ****     can_filter_conf.FilterID2 = 0x7FF;
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 4


 104              		.loc 1 36 42 is_stmt 0 discriminator 4 view .LVU18
 105 0018 036C     		ldr	r3, [r0, #64]	@ unaligned
  36:bsp/can/bsp_can.c ****     can_filter_conf.FilterID2 = 0x7FF;
 106              		.loc 1 36 31 discriminator 4 view .LVU19
 107 001a 0493     		str	r3, [sp, #16]
  37:bsp/can/bsp_can.c ****     can_filter_conf.RxBufferIndex = (_instance->can_handle == &hfdcan1) ? can1_filter_idx++ : can2_
 108              		.loc 1 37 5 is_stmt 1 discriminator 4 view .LVU20
  37:bsp/can/bsp_can.c ****     can_filter_conf.RxBufferIndex = (_instance->can_handle == &hfdcan1) ? can1_filter_idx++ : can2_
 109              		.loc 1 37 31 is_stmt 0 discriminator 4 view .LVU21
 110 001c 40F2FF73 		movw	r3, #2047
 111 0020 0593     		str	r3, [sp, #20]
  38:bsp/can/bsp_can.c ****     can_filter_conf.IsCalibrationMsg = 0;
 112              		.loc 1 38 5 is_stmt 1 discriminator 4 view .LVU22
  38:bsp/can/bsp_can.c ****     can_filter_conf.IsCalibrationMsg = 0;
 113              		.loc 1 38 47 is_stmt 0 discriminator 4 view .LVU23
 114 0022 0268     		ldr	r2, [r0]	@ unaligned
  38:bsp/can/bsp_can.c ****     can_filter_conf.IsCalibrationMsg = 0;
 115              		.loc 1 38 93 discriminator 4 view .LVU24
 116 0024 0B4B     		ldr	r3, .L12
 117 0026 9A42     		cmp	r2, r3
 118 0028 0FD0     		beq	.L11
  38:bsp/can/bsp_can.c ****     can_filter_conf.IsCalibrationMsg = 0;
 119              		.loc 1 38 110 discriminator 2 view .LVU25
 120 002a 0B4A     		ldr	r2, .L12+4
 121 002c 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 122 002e 591C     		adds	r1, r3, #1
 123 0030 1170     		strb	r1, [r2]
 124              	.L8:
  38:bsp/can/bsp_can.c ****     can_filter_conf.IsCalibrationMsg = 0;
 125              		.loc 1 38 35 discriminator 4 view .LVU26
 126 0032 0693     		str	r3, [sp, #24]
  39:bsp/can/bsp_can.c ****     HAL_FDCAN_ConfigFilter(_instance->can_handle, &can_filter_conf);
 127              		.loc 1 39 5 is_stmt 1 discriminator 4 view .LVU27
  39:bsp/can/bsp_can.c ****     HAL_FDCAN_ConfigFilter(_instance->can_handle, &can_filter_conf);
 128              		.loc 1 39 38 is_stmt 0 discriminator 4 view .LVU28
 129 0034 0023     		movs	r3, #0
 130 0036 0793     		str	r3, [sp, #28]
  40:bsp/can/bsp_can.c **** }
 131              		.loc 1 40 5 is_stmt 1 discriminator 4 view .LVU29
 132 0038 6946     		mov	r1, sp
 133 003a 0068     		ldr	r0, [r0]	@ unaligned
 134              	.LVL4:
  40:bsp/can/bsp_can.c **** }
 135              		.loc 1 40 5 is_stmt 0 discriminator 4 view .LVU30
 136 003c FFF7FEFF 		bl	HAL_FDCAN_ConfigFilter
 137              	.LVL5:
  41:bsp/can/bsp_can.c **** 
 138              		.loc 1 41 1 discriminator 4 view .LVU31
 139 0040 09B0     		add	sp, sp, #36
 140              	.LCFI3:
 141              		.cfi_remember_state
 142              		.cfi_def_cfa_offset 4
 143              		@ sp needed
 144 0042 5DF804FB 		ldr	pc, [sp], #4
 145              	.LVL6:
 146              	.L9:
 147              	.LCFI4:
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 5


 148              		.cfi_restore_state
  35:bsp/can/bsp_can.c ****     can_filter_conf.FilterID1 = _instance->rx_id;
 149              		.loc 1 35 85 view .LVU32
 150 0046 0223     		movs	r3, #2
 151 0048 E5E7     		b	.L6
 152              	.L11:
  38:bsp/can/bsp_can.c ****     can_filter_conf.IsCalibrationMsg = 0;
 153              		.loc 1 38 90 discriminator 1 view .LVU33
 154 004a 044A     		ldr	r2, .L12+8
 155 004c 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 156 004e 591C     		adds	r1, r3, #1
 157 0050 1170     		strb	r1, [r2]
 158 0052 EEE7     		b	.L8
 159              	.L13:
 160              		.align	2
 161              	.L12:
 162 0054 00000000 		.word	hfdcan1
 163 0058 00000000 		.word	.LANCHOR1
 164 005c 00000000 		.word	.LANCHOR0
 165              		.cfi_endproc
 166              	.LFE144:
 168              		.section	.text.CANFIFOxCallback,"ax",%progbits
 169              		.align	1
 170              		.syntax unified
 171              		.thumb
 172              		.thumb_func
 174              	CANFIFOxCallback:
 175              	.LVL7:
 176              	.LFB149:
  58:bsp/can/bsp_can.c **** 
  59:bsp/can/bsp_can.c **** /* ----------------------- two extern callable function -----------------------*/
  60:bsp/can/bsp_can.c **** /**
  61:bsp/can/bsp_can.c ****  * @brief used to initialize and register a CAN instance. It configures the CAN hardware
  62:bsp/can/bsp_can.c ****  *        if it's the first instance being registered and sets up the transmission
  63:bsp/can/bsp_can.c ****  *        and reception parameters.
  64:bsp/can/bsp_can.c ****  */
  65:bsp/can/bsp_can.c **** CANInstance *CANRegister(CAN_Init_Config_s *config)
  66:bsp/can/bsp_can.c **** {
  67:bsp/can/bsp_can.c ****     if (!idx)
  68:bsp/can/bsp_can.c ****     {
  69:bsp/can/bsp_can.c ****         CANServiceInit(); // ç¬¬ä¸€æ¬¡æ³¨å†Œ,å…ˆè¿›è¡Œç¡¬ä»¶åˆå§‹åŒ–
  70:bsp/can/bsp_can.c ****         // LOGINFO("[bsp_can] CAN Service Init");
  71:bsp/can/bsp_can.c ****     }
  72:bsp/can/bsp_can.c ****     if (idx >= CAN_MX_REGISTER_CNT) // è¶…è¿‡æœ€å¤§å®ä¾‹æ•°
  73:bsp/can/bsp_can.c ****     {
  74:bsp/can/bsp_can.c ****         while (1)
  75:bsp/can/bsp_can.c ****             ;
  76:bsp/can/bsp_can.c ****         // LOGERROR("[bsp_can] CAN instance exceeded MAX num, consider balance the load of CAN bus"
  77:bsp/can/bsp_can.c ****     }
  78:bsp/can/bsp_can.c ****     for (size_t i = 0; i < idx; i++)
  79:bsp/can/bsp_can.c ****     { // é‡å¤æ³¨å†Œ | idé‡å¤
  80:bsp/can/bsp_can.c ****         if (can_instance[i]->rx_id == config->rx_id && can_instance[i]->can_handle == config->can_h
  81:bsp/can/bsp_can.c ****         {
  82:bsp/can/bsp_can.c ****             while (1)
  83:bsp/can/bsp_can.c ****                 ;
  84:bsp/can/bsp_can.c ****             // LOGERROR("[bsp_can] CAN id crash ,tx [%d] or rx [%d] already registered", &config->t
  85:bsp/can/bsp_can.c ****         }
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 6


  86:bsp/can/bsp_can.c ****     }
  87:bsp/can/bsp_can.c **** 
  88:bsp/can/bsp_can.c ****     CANInstance *instance = (CANInstance *)malloc(sizeof(CANInstance)); // åˆ†é…ç©ºé—´
  89:bsp/can/bsp_can.c ****     memset(instance, 0, sizeof(CANInstance));                           // åˆ†é…çš„ç©ºé—´æœªå¿…æ˜¯
  90:bsp/can/bsp_can.c ****     // è¿›è¡Œå‘é€æŠ¥æ–‡çš„é…ç½®
  91:bsp/can/bsp_can.c ****     instance->txconf.Identifier = config->tx_id;
  92:bsp/can/bsp_can.c ****     instance->txconf.IdType = FDCAN_STANDARD_ID;     // ä½¿ç”¨æ ‡å‡†id,æ‰©å±•idåˆ™ä½¿ç”¨FDCAN_EXTEN
  93:bsp/can/bsp_can.c ****     instance->txconf.TxFrameType = FDCAN_DATA_FRAME; // å‘é€æ•°æ®å¸§
  94:bsp/can/bsp_can.c ****     instance->txconf.DataLength = FDCAN_DLC_BYTES_8; // é»˜è®¤å‘é€é•¿åº¦ä¸º8å­—èŠ‚
  95:bsp/can/bsp_can.c ****     instance->txconf.ErrorStateIndicator = FDCAN_ESI_ACTIVE;
  96:bsp/can/bsp_can.c ****     instance->txconf.BitRateSwitch = FDCAN_BRS_OFF; // ä¸ä½¿ç”¨æ¯”ç‰¹ç‡åˆ‡æ¢
  97:bsp/can/bsp_can.c ****     instance->txconf.FDFormat = FDCAN_CLASSIC_CAN;  // ä½¿ç”¨ç»å…¸CANæ ¼å¼
  98:bsp/can/bsp_can.c ****     instance->txconf.TxEventFifoControl = FDCAN_NO_TX_EVENTS;
  99:bsp/can/bsp_can.c ****     instance->txconf.MessageMarker = 0;
 100:bsp/can/bsp_can.c **** 
 101:bsp/can/bsp_can.c ****     // è®¾ç½®å›è°ƒå‡½æ•°å’Œæ¥æ”¶å‘é€id
 102:bsp/can/bsp_can.c ****     instance->can_handle = config->can_handle;
 103:bsp/can/bsp_can.c ****     instance->tx_id = config->tx_id; // å¥½åƒæ²¡ç”¨,å¯ä»¥åˆ æ‰
 104:bsp/can/bsp_can.c ****     instance->rx_id = config->rx_id;
 105:bsp/can/bsp_can.c ****     instance->can_module_callback = config->can_module_callback;
 106:bsp/can/bsp_can.c ****     instance->id = config->id;
 107:bsp/can/bsp_can.c **** 
 108:bsp/can/bsp_can.c ****     CANAddFilter(instance);         // æ·»åŠ CANè¿‡æ»¤å™¨è§„åˆ™
 109:bsp/can/bsp_can.c ****     can_instance[idx++] = instance; // å°†å®ä¾‹ä¿å­˜åˆ°can_instanceä¸­
 110:bsp/can/bsp_can.c **** 
 111:bsp/can/bsp_can.c ****     return instance; // è¿”å›canå®ä¾‹æŒ‡é’ˆ
 112:bsp/can/bsp_can.c **** }
 113:bsp/can/bsp_can.c **** 
 114:bsp/can/bsp_can.c **** void CANSetDLC(CANInstance *_instance, uint8_t length)
 115:bsp/can/bsp_can.c **** {
 116:bsp/can/bsp_can.c ****     // å‘é€é•¿åº¦é”™è¯¯!æ£€æŸ¥è°ƒç”¨å‚æ•°æ˜¯å¦å‡ºé”™,æˆ–å‡ºç°é‡æŒ‡é’ˆ/è¶Šç•Œè®¿é—®
 117:bsp/can/bsp_can.c ****     if (length > 8 || length == 0) // å®‰å…¨æ£€æŸ¥
 118:bsp/can/bsp_can.c ****         while (1)
 119:bsp/can/bsp_can.c ****             ;
 120:bsp/can/bsp_can.c ****     // LOGERROR("[bsp_can] CAN DLC error! check your code or wild pointer");
 121:bsp/can/bsp_can.c ****     _instance->txconf.DataLength = length;
 122:bsp/can/bsp_can.c **** }
 123:bsp/can/bsp_can.c **** 
 124:bsp/can/bsp_can.c **** /* @todo ç›®å‰ä¼¼ä¹å°è£…è¿‡åº¦,åº”è¯¥æ·»åŠ ä¸€ä¸ªæŒ‡å‘tx_buffçš„æŒ‡é’ˆ,tx_buffä¸åº”è¯¥ç”±CAN i
 125:bsp/can/bsp_can.c **** /* å¦‚æœè®©CANinstanceä¿å­˜txbuff,ä¼šå¢åŠ ä¸€æ¬¡å¤åˆ¶çš„å¼€é”€ */
 126:bsp/can/bsp_can.c **** uint8_t CANTransmit(CANInstance *_instance, float timeout)
 127:bsp/can/bsp_can.c **** {
 128:bsp/can/bsp_can.c ****     static uint32_t busy_count;
 129:bsp/can/bsp_can.c ****     static volatile float wait_time __attribute__((unused)); // for cancel warning
 130:bsp/can/bsp_can.c ****     float dwt_start = DWT_GetTimeline_ms();
 131:bsp/can/bsp_can.c ****     while (HAL_FDCAN_GetTxFifoFreeLevel(_instance->can_handle) == 0) // ç­‰å¾…é‚®ç®±ç©ºé—²
 132:bsp/can/bsp_can.c ****     {
 133:bsp/can/bsp_can.c ****         if (DWT_GetTimeline_ms() - dwt_start > timeout) // è¶…æ—¶
 134:bsp/can/bsp_can.c ****         {
 135:bsp/can/bsp_can.c ****             // LOGWARNING("[bsp_can] CAN MAILbox full! failed to add msg to mailbox. Cnt [%d]", bus
 136:bsp/can/bsp_can.c ****             busy_count++;
 137:bsp/can/bsp_can.c ****             return 0;
 138:bsp/can/bsp_can.c ****         }
 139:bsp/can/bsp_can.c ****     }
 140:bsp/can/bsp_can.c ****     wait_time = DWT_GetTimeline_ms() - dwt_start;
 141:bsp/can/bsp_can.c ****     // tx_mailboxä¼šä¿å­˜å®é™…å¡«å…¥äº†è¿™ä¸€å¸§æ¶ˆæ¯çš„é‚®ç®±,ä½†æ˜¯çŸ¥é“æ˜¯å“ªä¸ªé‚®ç®±å‘çš„
 142:bsp/can/bsp_can.c ****     if (HAL_FDCAN_AddMessageToTxFifoQ(_instance->can_handle, &_instance->txconf, _instance->tx_buff
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 7


 143:bsp/can/bsp_can.c ****     {
 144:bsp/can/bsp_can.c ****         // LOGWARNING("[bsp_can] CAN bus BUS! cnt:%d", busy_count);
 145:bsp/can/bsp_can.c ****         busy_count++;
 146:bsp/can/bsp_can.c ****         return 0;
 147:bsp/can/bsp_can.c ****     }
 148:bsp/can/bsp_can.c ****     return 1; // å‘é€æˆåŠŸ
 149:bsp/can/bsp_can.c **** }
 150:bsp/can/bsp_can.c **** 
 151:bsp/can/bsp_can.c **** /* -----------------------belows are callback definitions--------------------------*/
 152:bsp/can/bsp_can.c **** 
 153:bsp/can/bsp_can.c **** /**
 154:bsp/can/bsp_can.c ****  * @brief æ­¤å‡½æ•°ä¼šè¢«ä¸‹é¢ä¸¤ä¸ªå‡½æ•°è°ƒç”¨,ç”¨äºå¤„ç†FIFO0å’ŒFIFO1æº¢å‡ºä¸­æ–­(è¯´æ˜æ”¶åˆ
 155:bsp/can/bsp_can.c ****  *        æ‰€æœ‰çš„å®ä¾‹éƒ½ä¼šè¢«éå†,æ‰¾åˆ°can_handleå’Œrx_idç›¸ç­‰çš„å®ä¾‹æ—¶,è°ƒç”¨è¯¥å®ä¾‹
 156:bsp/can/bsp_can.c ****  *
 157:bsp/can/bsp_can.c ****  * @param _hcan
 158:bsp/can/bsp_can.c ****  * @param fifox passed to HAL_CAN_GetRxMessage() to get mesg from a specific fifo
 159:bsp/can/bsp_can.c ****  */
 160:bsp/can/bsp_can.c **** static void CANFIFOxCallback(FDCAN_HandleTypeDef *_hcan, uint32_t fifox)
 161:bsp/can/bsp_can.c **** {
 177              		.loc 1 161 1 is_stmt 1 view -0
 178              		.cfi_startproc
 179              		@ args = 0, pretend = 0, frame = 8
 180              		@ frame_needed = 0, uses_anonymous_args = 0
 181              		.loc 1 161 1 is_stmt 0 view .LVU35
 182 0000 70B5     		push	{r4, r5, r6, lr}
 183              	.LCFI5:
 184              		.cfi_def_cfa_offset 16
 185              		.cfi_offset 4, -16
 186              		.cfi_offset 5, -12
 187              		.cfi_offset 6, -8
 188              		.cfi_offset 14, -4
 189 0002 82B0     		sub	sp, sp, #8
 190              	.LCFI6:
 191              		.cfi_def_cfa_offset 24
 192 0004 0546     		mov	r5, r0
 193 0006 0E46     		mov	r6, r1
 162:bsp/can/bsp_can.c ****     static FDCAN_RxHeaderTypeDef rxconf; // åŒä¸Š
 194              		.loc 1 162 5 is_stmt 1 view .LVU36
 163:bsp/can/bsp_can.c ****     uint8_t can_rx_buff[8];
 195              		.loc 1 163 5 view .LVU37
 164:bsp/can/bsp_can.c ****     while (HAL_FDCAN_GetRxFifoFillLevel(_hcan, fifox)) // FIFOä¸ä¸ºç©º,æœ‰å¯èƒ½åœ¨å…¶ä»–ä¸­æ–­æ—¶
 196              		.loc 1 164 5 view .LVU38
 197              	.LVL8:
 198              	.L15:
 199              		.loc 1 164 11 view .LVU39
 200              		.loc 1 164 12 is_stmt 0 view .LVU40
 201 0008 3146     		mov	r1, r6
 202 000a 2846     		mov	r0, r5
 203 000c FFF7FEFF 		bl	HAL_FDCAN_GetRxFifoFillLevel
 204              	.LVL9:
 205              		.loc 1 164 11 view .LVU41
 206 0010 40B3     		cbz	r0, .L14
 165:bsp/can/bsp_can.c ****     {
 166:bsp/can/bsp_can.c ****         HAL_FDCAN_GetRxMessage(_hcan, fifox, &rxconf, can_rx_buff); // ä»FIFOä¸­è·å–æ•°æ®
 207              		.loc 1 166 9 is_stmt 1 view .LVU42
 208 0012 6B46     		mov	r3, sp
 209 0014 144A     		ldr	r2, .L23
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 8


 210 0016 3146     		mov	r1, r6
 211 0018 2846     		mov	r0, r5
 212 001a FFF7FEFF 		bl	HAL_FDCAN_GetRxMessage
 213              	.LVL10:
 167:bsp/can/bsp_can.c ****         for (size_t i = 0; i < idx; ++i)
 214              		.loc 1 167 9 view .LVU43
 215              	.LBB2:
 216              		.loc 1 167 14 view .LVU44
 217              		.loc 1 167 21 is_stmt 0 view .LVU45
 218 001e 0024     		movs	r4, #0
 219              		.loc 1 167 9 view .LVU46
 220 0020 00E0     		b	.L16
 221              	.LVL11:
 222              	.L17:
 223              		.loc 1 167 37 is_stmt 1 discriminator 2 view .LVU47
 224 0022 0134     		adds	r4, r4, #1
 225              	.LVL12:
 226              	.L16:
 227              		.loc 1 167 28 discriminator 1 view .LVU48
 228              		.loc 1 167 30 is_stmt 0 discriminator 1 view .LVU49
 229 0024 114B     		ldr	r3, .L23+4
 230 0026 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 231              		.loc 1 167 9 discriminator 1 view .LVU50
 232 0028 A342     		cmp	r3, r4
 233 002a EDD9     		bls	.L15
 168:bsp/can/bsp_can.c ****         { // ä¸¤è€…ç›¸ç­‰è¯´æ˜è¿™æ˜¯è¦æ‰¾çš„å®ä¾‹
 169:bsp/can/bsp_can.c ****             if (_hcan == can_instance[i]->can_handle && rxconf.Identifier == can_instance[i]->rx_id
 234              		.loc 1 169 13 is_stmt 1 view .LVU51
 235              		.loc 1 169 38 is_stmt 0 view .LVU52
 236 002c 104B     		ldr	r3, .L23+8
 237 002e 53F82400 		ldr	r0, [r3, r4, lsl #2]
 238              		.loc 1 169 41 view .LVU53
 239 0032 0268     		ldr	r2, [r0]	@ unaligned
 240              		.loc 1 169 16 view .LVU54
 241 0034 AA42     		cmp	r2, r5
 242 0036 F4D1     		bne	.L17
 243              		.loc 1 169 63 discriminator 1 view .LVU55
 244 0038 0B4A     		ldr	r2, .L23
 245 003a 1168     		ldr	r1, [r2]
 246              		.loc 1 169 93 discriminator 1 view .LVU56
 247 003c 026C     		ldr	r2, [r0, #64]	@ unaligned
 248              		.loc 1 169 54 discriminator 1 view .LVU57
 249 003e 9142     		cmp	r1, r2
 250 0040 EFD1     		bne	.L17
 170:bsp/can/bsp_can.c ****             {
 171:bsp/can/bsp_can.c ****                 if (can_instance[i]->can_module_callback != NULL) // å›è°ƒå‡½æ•°ä¸ä¸ºç©ºå°±è°ƒç”¨
 251              		.loc 1 171 17 is_stmt 1 view .LVU58
 252              		.loc 1 171 36 is_stmt 0 view .LVU59
 253 0042 D0F84520 		ldr	r2, [r0, #69]	@ unaligned
 254              		.loc 1 171 20 view .LVU60
 255 0046 6AB1     		cbz	r2, .L14
 172:bsp/can/bsp_can.c ****                 {
 173:bsp/can/bsp_can.c ****                     can_instance[i]->rx_len = rxconf.DataLength;                      // ä¿å­˜æ¥æ
 256              		.loc 1 173 21 is_stmt 1 view .LVU61
 257              		.loc 1 173 53 is_stmt 0 view .LVU62
 258 0048 074A     		ldr	r2, .L23
 259 004a D268     		ldr	r2, [r2, #12]
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 9


 260              		.loc 1 173 45 view .LVU63
 261 004c 80F84420 		strb	r2, [r0, #68]
 174:bsp/can/bsp_can.c ****                     memcpy(can_instance[i]->rx_buff, can_rx_buff, rxconf.DataLength); // æ¶ˆæ¯æ‹·è
 262              		.loc 1 174 21 is_stmt 1 view .LVU64
 263 0050 6946     		mov	r1, sp
 264 0052 3830     		adds	r0, r0, #56
 265 0054 FFF7FEFF 		bl	memcpy
 266              	.LVL13:
 175:bsp/can/bsp_can.c ****                     can_instance[i]->can_module_callback(can_instance[i]);            // è§¦å‘å›è
 267              		.loc 1 175 21 view .LVU65
 268              		.loc 1 175 33 is_stmt 0 view .LVU66
 269 0058 054B     		ldr	r3, .L23+8
 270 005a 53F82400 		ldr	r0, [r3, r4, lsl #2]
 271              		.loc 1 175 36 view .LVU67
 272 005e D0F84530 		ldr	r3, [r0, #69]	@ unaligned
 273              		.loc 1 175 21 view .LVU68
 274 0062 9847     		blx	r3
 275              	.LVL14:
 176:bsp/can/bsp_can.c ****                 }
 177:bsp/can/bsp_can.c ****                 return;
 276              		.loc 1 177 17 is_stmt 1 view .LVU69
 277              	.L14:
 278              		.loc 1 177 17 is_stmt 0 view .LVU70
 279              	.LBE2:
 178:bsp/can/bsp_can.c ****             }
 179:bsp/can/bsp_can.c ****         }
 180:bsp/can/bsp_can.c ****     }
 181:bsp/can/bsp_can.c **** }
 280              		.loc 1 181 1 view .LVU71
 281 0064 02B0     		add	sp, sp, #8
 282              	.LCFI7:
 283              		.cfi_def_cfa_offset 16
 284              		@ sp needed
 285 0066 70BD     		pop	{r4, r5, r6, pc}
 286              	.LVL15:
 287              	.L24:
 288              		.loc 1 181 1 view .LVU72
 289              		.align	2
 290              	.L23:
 291 0068 00000000 		.word	.LANCHOR2
 292 006c 00000000 		.word	.LANCHOR4
 293 0070 00000000 		.word	.LANCHOR3
 294              		.cfi_endproc
 295              	.LFE149:
 297              		.section	.text.CANRegister,"ax",%progbits
 298              		.align	1
 299              		.global	CANRegister
 300              		.syntax unified
 301              		.thumb
 302              		.thumb_func
 304              	CANRegister:
 305              	.LVL16:
 306              	.LFB146:
  66:bsp/can/bsp_can.c ****     if (!idx)
 307              		.loc 1 66 1 is_stmt 1 view -0
 308              		.cfi_startproc
 309              		@ args = 0, pretend = 0, frame = 0
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 10


 310              		@ frame_needed = 0, uses_anonymous_args = 0
  66:bsp/can/bsp_can.c ****     if (!idx)
 311              		.loc 1 66 1 is_stmt 0 view .LVU74
 312 0000 38B5     		push	{r3, r4, r5, lr}
 313              	.LCFI8:
 314              		.cfi_def_cfa_offset 16
 315              		.cfi_offset 3, -16
 316              		.cfi_offset 4, -12
 317              		.cfi_offset 5, -8
 318              		.cfi_offset 14, -4
 319 0002 0446     		mov	r4, r0
  67:bsp/can/bsp_can.c ****     {
 320              		.loc 1 67 5 is_stmt 1 view .LVU75
  67:bsp/can/bsp_can.c ****     {
 321              		.loc 1 67 9 is_stmt 0 view .LVU76
 322 0004 224B     		ldr	r3, .L36
 323 0006 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  67:bsp/can/bsp_can.c ****     {
 324              		.loc 1 67 8 view .LVU77
 325 0008 33B1     		cbz	r3, .L34
 326              	.LVL17:
 327              	.L26:
  72:bsp/can/bsp_can.c ****     {
 328              		.loc 1 72 5 is_stmt 1 view .LVU78
  72:bsp/can/bsp_can.c ****     {
 329              		.loc 1 72 13 is_stmt 0 view .LVU79
 330 000a 214B     		ldr	r3, .L36
 331 000c 93F800C0 		ldrb	ip, [r3]	@ zero_extendqisi2
  72:bsp/can/bsp_can.c ****     {
 332              		.loc 1 72 8 view .LVU80
 333 0010 BCF10F0F 		cmp	ip, #15
 334 0014 12D9     		bls	.L32
 335              	.L28:
  74:bsp/can/bsp_can.c ****             ;
 336              		.loc 1 74 9 is_stmt 1 discriminator 1 view .LVU81
  75:bsp/can/bsp_can.c ****         // LOGERROR("[bsp_can] CAN instance exceeded MAX num, consider balance the load of CAN bus"
 337              		.loc 1 75 13 discriminator 1 view .LVU82
  74:bsp/can/bsp_can.c ****             ;
 338              		.loc 1 74 15 discriminator 1 view .LVU83
 339 0016 FEE7     		b	.L28
 340              	.LVL18:
 341              	.L34:
  69:bsp/can/bsp_can.c ****         // LOGINFO("[bsp_can] CAN Service Init");
 342              		.loc 1 69 9 view .LVU84
 343 0018 FFF7FEFF 		bl	CANServiceInit
 344              	.LVL19:
  69:bsp/can/bsp_can.c ****         // LOGINFO("[bsp_can] CAN Service Init");
 345              		.loc 1 69 9 is_stmt 0 view .LVU85
 346 001c F5E7     		b	.L26
 347              	.LVL20:
 348              	.L29:
 349              	.LBB3:
  78:bsp/can/bsp_can.c ****     { // é‡å¤æ³¨å†Œ | idé‡å¤
 350              		.loc 1 78 33 is_stmt 1 discriminator 2 view .LVU86
  78:bsp/can/bsp_can.c ****     { // é‡å¤æ³¨å†Œ | idé‡å¤
 351              		.loc 1 78 34 is_stmt 0 discriminator 2 view .LVU87
 352 001e 0133     		adds	r3, r3, #1
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 11


 353              	.LVL21:
 354              	.L27:
  78:bsp/can/bsp_can.c ****     { // é‡å¤æ³¨å†Œ | idé‡å¤
 355              		.loc 1 78 24 is_stmt 1 discriminator 1 view .LVU88
  78:bsp/can/bsp_can.c ****     { // é‡å¤æ³¨å†Œ | idé‡å¤
 356              		.loc 1 78 5 is_stmt 0 discriminator 1 view .LVU89
 357 0020 9C45     		cmp	ip, r3
 358 0022 0DD9     		bls	.L35
  80:bsp/can/bsp_can.c ****         {
 359              		.loc 1 80 9 is_stmt 1 view .LVU90
  80:bsp/can/bsp_can.c ****         {
 360              		.loc 1 80 25 is_stmt 0 view .LVU91
 361 0024 1B4A     		ldr	r2, .L36+4
 362 0026 52F82320 		ldr	r2, [r2, r3, lsl #2]
  80:bsp/can/bsp_can.c ****         {
 363              		.loc 1 80 28 view .LVU92
 364 002a 106C     		ldr	r0, [r2, #64]	@ unaligned
  80:bsp/can/bsp_can.c ****         {
 365              		.loc 1 80 45 view .LVU93
 366 002c A168     		ldr	r1, [r4, #8]
  80:bsp/can/bsp_can.c ****         {
 367              		.loc 1 80 12 view .LVU94
 368 002e 8842     		cmp	r0, r1
 369 0030 F5D1     		bne	.L29
  80:bsp/can/bsp_can.c ****         {
 370              		.loc 1 80 71 discriminator 1 view .LVU95
 371 0032 1168     		ldr	r1, [r2]	@ unaligned
  80:bsp/can/bsp_can.c ****         {
 372              		.loc 1 80 93 discriminator 1 view .LVU96
 373 0034 2268     		ldr	r2, [r4]
  80:bsp/can/bsp_can.c ****         {
 374              		.loc 1 80 53 discriminator 1 view .LVU97
 375 0036 9142     		cmp	r1, r2
 376 0038 F1D1     		bne	.L29
 377              	.L30:
  82:bsp/can/bsp_can.c ****                 ;
 378              		.loc 1 82 13 is_stmt 1 discriminator 2 view .LVU98
  83:bsp/can/bsp_can.c ****             // LOGERROR("[bsp_can] CAN id crash ,tx [%d] or rx [%d] already registered", &config->t
 379              		.loc 1 83 17 discriminator 2 view .LVU99
  82:bsp/can/bsp_can.c ****                 ;
 380              		.loc 1 82 19 discriminator 2 view .LVU100
 381 003a FEE7     		b	.L30
 382              	.LVL22:
 383              	.L32:
  78:bsp/can/bsp_can.c ****     { // é‡å¤æ³¨å†Œ | idé‡å¤
 384              		.loc 1 78 17 is_stmt 0 view .LVU101
 385 003c 0023     		movs	r3, #0
 386 003e EFE7     		b	.L27
 387              	.LVL23:
 388              	.L35:
  78:bsp/can/bsp_can.c ****     { // é‡å¤æ³¨å†Œ | idé‡å¤
 389              		.loc 1 78 17 view .LVU102
 390              	.LBE3:
  88:bsp/can/bsp_can.c ****     memset(instance, 0, sizeof(CANInstance));                           // åˆ†é…çš„ç©ºé—´æœªå¿…æ˜¯
 391              		.loc 1 88 5 is_stmt 1 view .LVU103
  88:bsp/can/bsp_can.c ****     memset(instance, 0, sizeof(CANInstance));                           // åˆ†é…çš„ç©ºé—´æœªå¿…æ˜¯
 392              		.loc 1 88 44 is_stmt 0 view .LVU104
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 12


 393 0040 4D20     		movs	r0, #77
 394 0042 FFF7FEFF 		bl	malloc
 395              	.LVL24:
  88:bsp/can/bsp_can.c ****     memset(instance, 0, sizeof(CANInstance));                           // åˆ†é…çš„ç©ºé—´æœªå¿…æ˜¯
 396              		.loc 1 88 44 view .LVU105
 397 0046 0546     		mov	r5, r0
 398              	.LVL25:
  89:bsp/can/bsp_can.c ****     // è¿›è¡Œå‘é€æŠ¥æ–‡çš„é…ç½®
 399              		.loc 1 89 5 is_stmt 1 view .LVU106
 400 0048 4D22     		movs	r2, #77
 401 004a 0021     		movs	r1, #0
 402 004c FFF7FEFF 		bl	memset
 403              	.LVL26:
  91:bsp/can/bsp_can.c ****     instance->txconf.IdType = FDCAN_STANDARD_ID;     // ä½¿ç”¨æ ‡å‡†id,æ‰©å±•idåˆ™ä½¿ç”¨FDCAN_EXTEN
 404              		.loc 1 91 5 view .LVU107
  91:bsp/can/bsp_can.c ****     instance->txconf.IdType = FDCAN_STANDARD_ID;     // ä½¿ç”¨æ ‡å‡†id,æ‰©å±•idåˆ™ä½¿ç”¨FDCAN_EXTEN
 405              		.loc 1 91 41 is_stmt 0 view .LVU108
 406 0050 6268     		ldr	r2, [r4, #4]
  91:bsp/can/bsp_can.c ****     instance->txconf.IdType = FDCAN_STANDARD_ID;     // ä½¿ç”¨æ ‡å‡†id,æ‰©å±•idåˆ™ä½¿ç”¨FDCAN_EXTEN
 407              		.loc 1 91 33 view .LVU109
 408 0052 6A60     		str	r2, [r5, #4]	@ unaligned
  92:bsp/can/bsp_can.c ****     instance->txconf.TxFrameType = FDCAN_DATA_FRAME; // å‘é€æ•°æ®å¸§
 409              		.loc 1 92 5 is_stmt 1 view .LVU110
  93:bsp/can/bsp_can.c ****     instance->txconf.DataLength = FDCAN_DLC_BYTES_8; // é»˜è®¤å‘é€é•¿åº¦ä¸º8å­—èŠ‚
 410              		.loc 1 93 5 view .LVU111
  94:bsp/can/bsp_can.c ****     instance->txconf.ErrorStateIndicator = FDCAN_ESI_ACTIVE;
 411              		.loc 1 94 5 view .LVU112
  94:bsp/can/bsp_can.c ****     instance->txconf.ErrorStateIndicator = FDCAN_ESI_ACTIVE;
 412              		.loc 1 94 33 is_stmt 0 view .LVU113
 413 0054 0023     		movs	r3, #0
 414 0056 0821     		movs	r1, #8
 415 0058 2974     		strb	r1, [r5, #16]
 416 005a 6B74     		strb	r3, [r5, #17]
 417 005c AB74     		strb	r3, [r5, #18]
 418 005e EB74     		strb	r3, [r5, #19]
  95:bsp/can/bsp_can.c ****     instance->txconf.BitRateSwitch = FDCAN_BRS_OFF; // ä¸ä½¿ç”¨æ¯”ç‰¹ç‡åˆ‡æ¢
 419              		.loc 1 95 5 is_stmt 1 view .LVU114
  96:bsp/can/bsp_can.c ****     instance->txconf.FDFormat = FDCAN_CLASSIC_CAN;  // ä½¿ç”¨ç»å…¸CANæ ¼å¼
 420              		.loc 1 96 5 view .LVU115
  97:bsp/can/bsp_can.c ****     instance->txconf.TxEventFifoControl = FDCAN_NO_TX_EVENTS;
 421              		.loc 1 97 5 view .LVU116
  98:bsp/can/bsp_can.c ****     instance->txconf.MessageMarker = 0;
 422              		.loc 1 98 5 view .LVU117
  99:bsp/can/bsp_can.c **** 
 423              		.loc 1 99 5 view .LVU118
 102:bsp/can/bsp_can.c ****     instance->tx_id = config->tx_id; // å¥½åƒæ²¡ç”¨,å¯ä»¥åˆ æ‰
 424              		.loc 1 102 5 view .LVU119
 102:bsp/can/bsp_can.c ****     instance->tx_id = config->tx_id; // å¥½åƒæ²¡ç”¨,å¯ä»¥åˆ æ‰
 425              		.loc 1 102 34 is_stmt 0 view .LVU120
 426 0060 2368     		ldr	r3, [r4]
 102:bsp/can/bsp_can.c ****     instance->tx_id = config->tx_id; // å¥½åƒæ²¡ç”¨,å¯ä»¥åˆ æ‰
 427              		.loc 1 102 26 view .LVU121
 428 0062 2B60     		str	r3, [r5]	@ unaligned
 103:bsp/can/bsp_can.c ****     instance->rx_id = config->rx_id;
 429              		.loc 1 103 5 is_stmt 1 view .LVU122
 103:bsp/can/bsp_can.c ****     instance->rx_id = config->rx_id;
 430              		.loc 1 103 21 is_stmt 0 view .LVU123
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 13


 431 0064 AA62     		str	r2, [r5, #40]	@ unaligned
 104:bsp/can/bsp_can.c ****     instance->can_module_callback = config->can_module_callback;
 432              		.loc 1 104 5 is_stmt 1 view .LVU124
 104:bsp/can/bsp_can.c ****     instance->can_module_callback = config->can_module_callback;
 433              		.loc 1 104 29 is_stmt 0 view .LVU125
 434 0066 A368     		ldr	r3, [r4, #8]
 104:bsp/can/bsp_can.c ****     instance->can_module_callback = config->can_module_callback;
 435              		.loc 1 104 21 view .LVU126
 436 0068 2B64     		str	r3, [r5, #64]	@ unaligned
 105:bsp/can/bsp_can.c ****     instance->id = config->id;
 437              		.loc 1 105 5 is_stmt 1 view .LVU127
 105:bsp/can/bsp_can.c ****     instance->id = config->id;
 438              		.loc 1 105 43 is_stmt 0 view .LVU128
 439 006a E368     		ldr	r3, [r4, #12]
 105:bsp/can/bsp_can.c ****     instance->id = config->id;
 440              		.loc 1 105 35 view .LVU129
 441 006c C5F84530 		str	r3, [r5, #69]	@ unaligned
 106:bsp/can/bsp_can.c **** 
 442              		.loc 1 106 5 is_stmt 1 view .LVU130
 106:bsp/can/bsp_can.c **** 
 443              		.loc 1 106 26 is_stmt 0 view .LVU131
 444 0070 2369     		ldr	r3, [r4, #16]
 106:bsp/can/bsp_can.c **** 
 445              		.loc 1 106 18 view .LVU132
 446 0072 C5F84930 		str	r3, [r5, #73]	@ unaligned
 108:bsp/can/bsp_can.c ****     can_instance[idx++] = instance; // å°†å®ä¾‹ä¿å­˜åˆ°can_instanceä¸­
 447              		.loc 1 108 5 is_stmt 1 view .LVU133
 448 0076 2846     		mov	r0, r5
 449 0078 FFF7FEFF 		bl	CANAddFilter
 450              	.LVL27:
 109:bsp/can/bsp_can.c **** 
 451              		.loc 1 109 5 view .LVU134
 109:bsp/can/bsp_can.c **** 
 452              		.loc 1 109 21 is_stmt 0 view .LVU135
 453 007c 044A     		ldr	r2, .L36
 454 007e 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 455 0080 591C     		adds	r1, r3, #1
 456 0082 1170     		strb	r1, [r2]
 109:bsp/can/bsp_can.c **** 
 457              		.loc 1 109 25 view .LVU136
 458 0084 034A     		ldr	r2, .L36+4
 459 0086 42F82350 		str	r5, [r2, r3, lsl #2]
 111:bsp/can/bsp_can.c **** }
 460              		.loc 1 111 5 is_stmt 1 view .LVU137
 112:bsp/can/bsp_can.c **** 
 461              		.loc 1 112 1 is_stmt 0 view .LVU138
 462 008a 2846     		mov	r0, r5
 463 008c 38BD     		pop	{r3, r4, r5, pc}
 464              	.LVL28:
 465              	.L37:
 112:bsp/can/bsp_can.c **** 
 466              		.loc 1 112 1 view .LVU139
 467 008e 00BF     		.align	2
 468              	.L36:
 469 0090 00000000 		.word	.LANCHOR4
 470 0094 00000000 		.word	.LANCHOR3
 471              		.cfi_endproc
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 14


 472              	.LFE146:
 474              		.section	.text.CANSetDLC,"ax",%progbits
 475              		.align	1
 476              		.global	CANSetDLC
 477              		.syntax unified
 478              		.thumb
 479              		.thumb_func
 481              	CANSetDLC:
 482              	.LVL29:
 483              	.LFB147:
 115:bsp/can/bsp_can.c ****     // å‘é€é•¿åº¦é”™è¯¯!æ£€æŸ¥è°ƒç”¨å‚æ•°æ˜¯å¦å‡ºé”™,æˆ–å‡ºç°é‡æŒ‡é’ˆ/è¶Šç•Œè®¿é—®
 484              		.loc 1 115 1 is_stmt 1 view -0
 485              		.cfi_startproc
 486              		@ args = 0, pretend = 0, frame = 0
 487              		@ frame_needed = 0, uses_anonymous_args = 0
 488              		@ link register save eliminated.
 117:bsp/can/bsp_can.c ****         while (1)
 489              		.loc 1 117 5 view .LVU141
 117:bsp/can/bsp_can.c ****         while (1)
 490              		.loc 1 117 20 is_stmt 0 view .LVU142
 491 0000 4B1E     		subs	r3, r1, #1
 492 0002 DBB2     		uxtb	r3, r3
 117:bsp/can/bsp_can.c ****         while (1)
 493              		.loc 1 117 8 view .LVU143
 494 0004 072B     		cmp	r3, #7
 495 0006 00D9     		bls	.L39
 496              	.L40:
 118:bsp/can/bsp_can.c ****             ;
 497              		.loc 1 118 9 is_stmt 1 discriminator 1 view .LVU144
 119:bsp/can/bsp_can.c ****     // LOGERROR("[bsp_can] CAN DLC error! check your code or wild pointer");
 498              		.loc 1 119 13 discriminator 1 view .LVU145
 118:bsp/can/bsp_can.c ****             ;
 499              		.loc 1 118 15 discriminator 1 view .LVU146
 500 0008 FEE7     		b	.L40
 501              	.L39:
 121:bsp/can/bsp_can.c **** }
 502              		.loc 1 121 5 view .LVU147
 121:bsp/can/bsp_can.c **** }
 503              		.loc 1 121 34 is_stmt 0 view .LVU148
 504 000a 0161     		str	r1, [r0, #16]	@ unaligned
 122:bsp/can/bsp_can.c **** 
 505              		.loc 1 122 1 view .LVU149
 506 000c 7047     		bx	lr
 507              		.cfi_endproc
 508              	.LFE147:
 510              		.section	.text.CANTransmit,"ax",%progbits
 511              		.align	1
 512              		.global	CANTransmit
 513              		.syntax unified
 514              		.thumb
 515              		.thumb_func
 517              	CANTransmit:
 518              	.LVL30:
 519              	.LFB148:
 127:bsp/can/bsp_can.c ****     static uint32_t busy_count;
 520              		.loc 1 127 1 is_stmt 1 view -0
 521              		.cfi_startproc
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 15


 522              		@ args = 0, pretend = 0, frame = 0
 523              		@ frame_needed = 0, uses_anonymous_args = 0
 127:bsp/can/bsp_can.c ****     static uint32_t busy_count;
 524              		.loc 1 127 1 is_stmt 0 view .LVU151
 525 0000 10B5     		push	{r4, lr}
 526              	.LCFI9:
 527              		.cfi_def_cfa_offset 8
 528              		.cfi_offset 4, -8
 529              		.cfi_offset 14, -4
 530 0002 2DED028B 		vpush.64	{d8}
 531              	.LCFI10:
 532              		.cfi_def_cfa_offset 16
 533              		.cfi_offset 80, -16
 534              		.cfi_offset 81, -12
 535 0006 0446     		mov	r4, r0
 536 0008 F0EE408A 		vmov.f32	s17, s0
 128:bsp/can/bsp_can.c ****     static volatile float wait_time __attribute__((unused)); // for cancel warning
 537              		.loc 1 128 5 is_stmt 1 view .LVU152
 129:bsp/can/bsp_can.c ****     float dwt_start = DWT_GetTimeline_ms();
 538              		.loc 1 129 5 view .LVU153
 130:bsp/can/bsp_can.c ****     while (HAL_FDCAN_GetTxFifoFreeLevel(_instance->can_handle) == 0) // ç­‰å¾…é‚®ç®±ç©ºé—²
 539              		.loc 1 130 5 view .LVU154
 130:bsp/can/bsp_can.c ****     while (HAL_FDCAN_GetTxFifoFreeLevel(_instance->can_handle) == 0) // ç­‰å¾…é‚®ç®±ç©ºé—²
 540              		.loc 1 130 23 is_stmt 0 view .LVU155
 541 000c FFF7FEFF 		bl	DWT_GetTimeline_ms
 542              	.LVL31:
 130:bsp/can/bsp_can.c ****     while (HAL_FDCAN_GetTxFifoFreeLevel(_instance->can_handle) == 0) // ç­‰å¾…é‚®ç®±ç©ºé—²
 543              		.loc 1 130 23 view .LVU156
 544 0010 B0EE408A 		vmov.f32	s16, s0
 545              	.LVL32:
 131:bsp/can/bsp_can.c ****     {
 546              		.loc 1 131 5 is_stmt 1 view .LVU157
 547              	.L42:
 131:bsp/can/bsp_can.c ****     {
 548              		.loc 1 131 11 view .LVU158
 131:bsp/can/bsp_can.c ****     {
 549              		.loc 1 131 12 is_stmt 0 view .LVU159
 550 0014 2068     		ldr	r0, [r4]	@ unaligned
 551 0016 FFF7FEFF 		bl	HAL_FDCAN_GetTxFifoFreeLevel
 552              	.LVL33:
 131:bsp/can/bsp_can.c ****     {
 553              		.loc 1 131 11 view .LVU160
 554 001a 80B9     		cbnz	r0, .L49
 133:bsp/can/bsp_can.c ****         {
 555              		.loc 1 133 9 is_stmt 1 view .LVU161
 133:bsp/can/bsp_can.c ****         {
 556              		.loc 1 133 13 is_stmt 0 view .LVU162
 557 001c FFF7FEFF 		bl	DWT_GetTimeline_ms
 558              	.LVL34:
 133:bsp/can/bsp_can.c ****         {
 559              		.loc 1 133 34 view .LVU163
 560 0020 30EE480A 		vsub.f32	s0, s0, s16
 133:bsp/can/bsp_can.c ****         {
 561              		.loc 1 133 12 view .LVU164
 562 0024 B4EEE80A 		vcmpe.f32	s0, s17
 563 0028 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 564 002c F2DD     		ble	.L42
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 16


 136:bsp/can/bsp_can.c ****             return 0;
 565              		.loc 1 136 13 is_stmt 1 view .LVU165
 136:bsp/can/bsp_can.c ****             return 0;
 566              		.loc 1 136 23 is_stmt 0 view .LVU166
 567 002e 0F4A     		ldr	r2, .L51
 568 0030 1368     		ldr	r3, [r2]
 569 0032 0133     		adds	r3, r3, #1
 570 0034 1360     		str	r3, [r2]
 137:bsp/can/bsp_can.c ****         }
 571              		.loc 1 137 13 is_stmt 1 view .LVU167
 137:bsp/can/bsp_can.c ****         }
 572              		.loc 1 137 20 is_stmt 0 view .LVU168
 573 0036 0020     		movs	r0, #0
 574              	.LVL35:
 575              	.L44:
 149:bsp/can/bsp_can.c **** 
 576              		.loc 1 149 1 view .LVU169
 577 0038 BDEC028B 		vldm	sp!, {d8}
 578              	.LCFI11:
 579              		.cfi_remember_state
 580              		.cfi_restore 80
 581              		.cfi_restore 81
 582              		.cfi_def_cfa_offset 8
 583 003c 10BD     		pop	{r4, pc}
 584              	.LVL36:
 585              	.L49:
 586              	.LCFI12:
 587              		.cfi_restore_state
 140:bsp/can/bsp_can.c ****     // tx_mailboxä¼šä¿å­˜å®é™…å¡«å…¥äº†è¿™ä¸€å¸§æ¶ˆæ¯çš„é‚®ç®±,ä½†æ˜¯çŸ¥é“æ˜¯å“ªä¸ªé‚®ç®±å‘çš„
 588              		.loc 1 140 5 is_stmt 1 view .LVU170
 140:bsp/can/bsp_can.c ****     // tx_mailboxä¼šä¿å­˜å®é™…å¡«å…¥äº†è¿™ä¸€å¸§æ¶ˆæ¯çš„é‚®ç®±,ä½†æ˜¯çŸ¥é“æ˜¯å“ªä¸ªé‚®ç®±å‘çš„
 589              		.loc 1 140 17 is_stmt 0 view .LVU171
 590 003e FFF7FEFF 		bl	DWT_GetTimeline_ms
 591              	.LVL37:
 140:bsp/can/bsp_can.c ****     // tx_mailboxä¼šä¿å­˜å®é™…å¡«å…¥äº†è¿™ä¸€å¸§æ¶ˆæ¯çš„é‚®ç®±,ä½†æ˜¯çŸ¥é“æ˜¯å“ªä¸ªé‚®ç®±å‘çš„
 592              		.loc 1 140 38 view .LVU172
 593 0042 30EE488A 		vsub.f32	s16, s0, s16
 594              	.LVL38:
 140:bsp/can/bsp_can.c ****     // tx_mailboxä¼šä¿å­˜å®é™…å¡«å…¥äº†è¿™ä¸€å¸§æ¶ˆæ¯çš„é‚®ç®±,ä½†æ˜¯çŸ¥é“æ˜¯å“ªä¸ªé‚®ç®±å‘çš„
 595              		.loc 1 140 15 view .LVU173
 596 0046 0A4B     		ldr	r3, .L51+4
 597 0048 83ED008A 		vstr.32	s16, [r3]
 142:bsp/can/bsp_can.c ****     {
 598              		.loc 1 142 5 is_stmt 1 view .LVU174
 142:bsp/can/bsp_can.c ****     {
 599              		.loc 1 142 91 is_stmt 0 view .LVU175
 600 004c 2246     		mov	r2, r4
 142:bsp/can/bsp_can.c ****     {
 601              		.loc 1 142 9 view .LVU176
 602 004e 52F8300B 		ldr	r0, [r2], #48	@ unaligned
 603 0052 211D     		adds	r1, r4, #4
 604 0054 FFF7FEFF 		bl	HAL_FDCAN_AddMessageToTxFifoQ
 605              	.LVL39:
 142:bsp/can/bsp_can.c ****     {
 606              		.loc 1 142 8 view .LVU177
 607 0058 08B9     		cbnz	r0, .L50
 148:bsp/can/bsp_can.c **** }
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 17


 608              		.loc 1 148 12 view .LVU178
 609 005a 0120     		movs	r0, #1
 610 005c ECE7     		b	.L44
 611              	.L50:
 145:bsp/can/bsp_can.c ****         return 0;
 612              		.loc 1 145 9 is_stmt 1 view .LVU179
 145:bsp/can/bsp_can.c ****         return 0;
 613              		.loc 1 145 19 is_stmt 0 view .LVU180
 614 005e 034A     		ldr	r2, .L51
 615 0060 1368     		ldr	r3, [r2]
 616 0062 0133     		adds	r3, r3, #1
 617 0064 1360     		str	r3, [r2]
 146:bsp/can/bsp_can.c ****     }
 618              		.loc 1 146 9 is_stmt 1 view .LVU181
 146:bsp/can/bsp_can.c ****     }
 619              		.loc 1 146 16 is_stmt 0 view .LVU182
 620 0066 0020     		movs	r0, #0
 621 0068 E6E7     		b	.L44
 622              	.L52:
 623 006a 00BF     		.align	2
 624              	.L51:
 625 006c 00000000 		.word	.LANCHOR5
 626 0070 00000000 		.word	.LANCHOR6
 627              		.cfi_endproc
 628              	.LFE148:
 630              		.section	.text.HAL_FDCAN_RxFifo0Callback,"ax",%progbits
 631              		.align	1
 632              		.global	HAL_FDCAN_RxFifo0Callback
 633              		.syntax unified
 634              		.thumb
 635              		.thumb_func
 637              	HAL_FDCAN_RxFifo0Callback:
 638              	.LVL40:
 639              	.LFB150:
 182:bsp/can/bsp_can.c **** 
 183:bsp/can/bsp_can.c **** /**
 184:bsp/can/bsp_can.c ****  * @brief æ³¨æ„,STM32çš„ä¸¤ä¸ªCANè®¾å¤‡å…±äº«ä¸¤ä¸ªFIFO
 185:bsp/can/bsp_can.c ****  * ä¸‹é¢ä¸¤ä¸ªå‡½æ•°æ˜¯HALåº“ä¸­çš„å›è°ƒå‡½æ•°,ä»–ä»¬è¢«HALå£°æ˜ä¸º__weak,è¿™é‡Œå¯¹ä»–ä»¬è¿›è¡Œé
 186:bsp/can/bsp_can.c ****  * å½“FIFO0æˆ–FIFO1æº¢å‡ºæ—¶ä¼šè°ƒç”¨è¿™ä¸¤ä¸ªå‡½æ•°
 187:bsp/can/bsp_can.c ****  */
 188:bsp/can/bsp_can.c **** // ä¸‹é¢çš„å‡½æ•°ä¼šè°ƒç”¨CANFIFOxCallback()æ¥è¿›ä¸€æ­¥å¤„ç†æ¥è‡ªç‰¹å®šCANè®¾å¤‡çš„æ¶ˆæ¯
 189:bsp/can/bsp_can.c **** 
 190:bsp/can/bsp_can.c **** /**
 191:bsp/can/bsp_can.c ****  * @brief rx fifo callback. Once FIFO_0 is full,this func would be called
 192:bsp/can/bsp_can.c ****  *
 193:bsp/can/bsp_can.c ****  * @param hcan CAN handle indicate which device the oddest mesg in FIFO_0 comes from
 194:bsp/can/bsp_can.c ****  */
 195:bsp/can/bsp_can.c **** void HAL_FDCAN_RxFifo0Callback(FDCAN_HandleTypeDef *hcan, uint32_t RxFifo0ITs)
 196:bsp/can/bsp_can.c **** {
 640              		.loc 1 196 1 is_stmt 1 view -0
 641              		.cfi_startproc
 642              		@ args = 0, pretend = 0, frame = 0
 643              		@ frame_needed = 0, uses_anonymous_args = 0
 644              		.loc 1 196 1 is_stmt 0 view .LVU184
 645 0000 08B5     		push	{r3, lr}
 646              	.LCFI13:
 647              		.cfi_def_cfa_offset 8
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 18


 648              		.cfi_offset 3, -8
 649              		.cfi_offset 14, -4
 197:bsp/can/bsp_can.c ****     CANFIFOxCallback(hcan, FDCAN_RX_FIFO0); // è°ƒç”¨æˆ‘ä»¬è‡ªå·±å†™çš„å‡½æ•°æ¥å¤„ç†æ¶ˆæ¯
 650              		.loc 1 197 5 is_stmt 1 view .LVU185
 651 0002 4021     		movs	r1, #64
 652              	.LVL41:
 653              		.loc 1 197 5 is_stmt 0 view .LVU186
 654 0004 FFF7FEFF 		bl	CANFIFOxCallback
 655              	.LVL42:
 198:bsp/can/bsp_can.c **** }
 656              		.loc 1 198 1 view .LVU187
 657 0008 08BD     		pop	{r3, pc}
 658              		.cfi_endproc
 659              	.LFE150:
 661              		.section	.text.HAL_FDCAN_RxFifo1Callback,"ax",%progbits
 662              		.align	1
 663              		.global	HAL_FDCAN_RxFifo1Callback
 664              		.syntax unified
 665              		.thumb
 666              		.thumb_func
 668              	HAL_FDCAN_RxFifo1Callback:
 669              	.LVL43:
 670              	.LFB151:
 199:bsp/can/bsp_can.c **** 
 200:bsp/can/bsp_can.c **** /**
 201:bsp/can/bsp_can.c ****  * @brief rx fifo callback. Once FIFO_1 is full,this func would be called
 202:bsp/can/bsp_can.c ****  *
 203:bsp/can/bsp_can.c ****  * @param hcan CAN handle indicate which device the oddest mesg in FIFO_1 comes from
 204:bsp/can/bsp_can.c ****  */
 205:bsp/can/bsp_can.c **** void HAL_FDCAN_RxFifo1Callback(FDCAN_HandleTypeDef *hcan, uint32_t RxFifo1ITs)
 206:bsp/can/bsp_can.c **** {
 671              		.loc 1 206 1 is_stmt 1 view -0
 672              		.cfi_startproc
 673              		@ args = 0, pretend = 0, frame = 0
 674              		@ frame_needed = 0, uses_anonymous_args = 0
 675              		.loc 1 206 1 is_stmt 0 view .LVU189
 676 0000 08B5     		push	{r3, lr}
 677              	.LCFI14:
 678              		.cfi_def_cfa_offset 8
 679              		.cfi_offset 3, -8
 680              		.cfi_offset 14, -4
 207:bsp/can/bsp_can.c ****     CANFIFOxCallback(hcan, FDCAN_RX_FIFO1); // è°ƒç”¨æˆ‘ä»¬è‡ªå·±å†™çš„å‡½æ•°æ¥å¤„ç†æ¶ˆæ¯
 681              		.loc 1 207 5 is_stmt 1 view .LVU190
 682 0002 4121     		movs	r1, #65
 683              	.LVL44:
 684              		.loc 1 207 5 is_stmt 0 view .LVU191
 685 0004 FFF7FEFF 		bl	CANFIFOxCallback
 686              	.LVL45:
 208:bsp/can/bsp_can.c **** }
 687              		.loc 1 208 1 view .LVU192
 688 0008 08BD     		pop	{r3, pc}
 689              		.cfi_endproc
 690              	.LFE151:
 692              		.section	.bss.busy_count.2,"aw",%nobits
 693              		.align	2
 694              		.set	.LANCHOR5,. + 0
 697              	busy_count.2:
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 19


 698 0000 00000000 		.space	4
 699              		.section	.bss.can1_filter_idx.4,"aw",%nobits
 700              		.set	.LANCHOR0,. + 0
 703              	can1_filter_idx.4:
 704 0000 00       		.space	1
 705              		.section	.bss.can_instance,"aw",%nobits
 706              		.align	2
 707              		.set	.LANCHOR3,. + 0
 710              	can_instance:
 711 0000 00000000 		.space	64
 711      00000000 
 711      00000000 
 711      00000000 
 711      00000000 
 712              		.section	.bss.idx,"aw",%nobits
 713              		.set	.LANCHOR4,. + 0
 716              	idx:
 717 0000 00       		.space	1
 718              		.section	.bss.rxconf.0,"aw",%nobits
 719              		.align	2
 720              		.set	.LANCHOR2,. + 0
 723              	rxconf.0:
 724 0000 00000000 		.space	40
 724      00000000 
 724      00000000 
 724      00000000 
 724      00000000 
 725              		.section	.bss.wait_time.1,"aw",%nobits
 726              		.align	2
 727              		.set	.LANCHOR6,. + 0
 730              	wait_time.1:
 731 0000 00000000 		.space	4
 732              		.section	.data.can2_filter_idx.3,"aw"
 733              		.set	.LANCHOR1,. + 0
 736              	can2_filter_idx.3:
 737 0000 0E       		.byte	14
 738              		.text
 739              	.Letext0:
 740              		.file 2 "d:\\rm\\arm-gnu-toolchian\\arm-none-eabi\\include\\machine\\_default_types.h"
 741              		.file 3 "d:\\rm\\arm-gnu-toolchian\\arm-none-eabi\\include\\sys\\_stdint.h"
 742              		.file 4 "Drivers/CMSIS/Device/ST/STM32H7xx/Include/stm32h743xx.h"
 743              		.file 5 "Drivers/CMSIS/Device/ST/STM32H7xx/Include/stm32h7xx.h"
 744              		.file 6 "d:\\rm\\arm-gnu-toolchian\\lib\\gcc\\arm-none-eabi\\10.3.1\\include\\stddef.h"
 745              		.file 7 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_def.h"
 746              		.file 8 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_fdcan.h"
 747              		.file 9 "bsp/can/bsp_can.h"
 748              		.file 10 "Core/Inc/fdcan.h"
 749              		.file 11 "bsp/dwt/bsp_dwt.h"
 750              		.file 12 "d:\\rm\\arm-gnu-toolchian\\arm-none-eabi\\include\\stdlib.h"
 751              		.file 13 "<built-in>"
ARM GAS  C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s 			page 20


DEFINED SYMBOLS
                            *ABS*:00000000 bsp_can.c
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:19     .text.CANServiceInit:00000000 $t
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:24     .text.CANServiceInit:00000000 CANServiceInit
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:58     .text.CANServiceInit:00000020 $d
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:63     .text.CANAddFilter:00000000 $t
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:68     .text.CANAddFilter:00000000 CANAddFilter
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:162    .text.CANAddFilter:00000054 $d
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:169    .text.CANFIFOxCallback:00000000 $t
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:174    .text.CANFIFOxCallback:00000000 CANFIFOxCallback
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:291    .text.CANFIFOxCallback:00000068 $d
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:298    .text.CANRegister:00000000 $t
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:304    .text.CANRegister:00000000 CANRegister
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:469    .text.CANRegister:00000090 $d
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:475    .text.CANSetDLC:00000000 $t
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:481    .text.CANSetDLC:00000000 CANSetDLC
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:511    .text.CANTransmit:00000000 $t
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:517    .text.CANTransmit:00000000 CANTransmit
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:625    .text.CANTransmit:0000006c $d
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:631    .text.HAL_FDCAN_RxFifo0Callback:00000000 $t
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:637    .text.HAL_FDCAN_RxFifo0Callback:00000000 HAL_FDCAN_RxFifo0Callback
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:662    .text.HAL_FDCAN_RxFifo1Callback:00000000 $t
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:668    .text.HAL_FDCAN_RxFifo1Callback:00000000 HAL_FDCAN_RxFifo1Callback
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:693    .bss.busy_count.2:00000000 $d
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:697    .bss.busy_count.2:00000000 busy_count.2
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:703    .bss.can1_filter_idx.4:00000000 can1_filter_idx.4
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:704    .bss.can1_filter_idx.4:00000000 $d
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:706    .bss.can_instance:00000000 $d
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:710    .bss.can_instance:00000000 can_instance
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:716    .bss.idx:00000000 idx
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:717    .bss.idx:00000000 $d
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:719    .bss.rxconf.0:00000000 $d
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:723    .bss.rxconf.0:00000000 rxconf.0
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:726    .bss.wait_time.1:00000000 $d
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:730    .bss.wait_time.1:00000000 wait_time.1
C:\Users\blue\AppData\Local\Temp\ccBZOCsl.s:736    .data.can2_filter_idx.3:00000000 can2_filter_idx.3

UNDEFINED SYMBOLS
HAL_FDCAN_Start
HAL_FDCAN_ActivateNotification
hfdcan1
HAL_FDCAN_ConfigFilter
HAL_FDCAN_GetRxFifoFillLevel
HAL_FDCAN_GetRxMessage
memcpy
malloc
memset
DWT_GetTimeline_ms
HAL_FDCAN_GetTxFifoFreeLevel
HAL_FDCAN_AddMessageToTxFifoQ
